var _this=this;!function(){"use strict";var e={};e.toID=function(e){return(""+e).toLowerCase().replace(/[^a-z0-9]+/g,"")},e.error=function(e,a){if(e)throw new Error(a);console.log(a)},e.assignWithout=function(e,a,t){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&!t.has(i)&&(e[i]=a[i])};var a={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object","[object Error]":"error"},t=a.toString,i=a.hasOwnProperty;function r(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?a[t.call(e)]||"object":typeof e}function s(e){if("object"!==r(e)||e.nodeType||function(e){return null!=e&&e===e.window}(e))return!1;try{if(e.constructor&&!i.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}return!0}e.extend=function e(){for(var a,t,i,o,n,l,h=[],c=0;c<arguments.length;c++)h[c]=arguments[c];var d=h[0]||{},y=1,u=!1,m=h.length;for("boolean"==typeof d&&(u=d,d=h[1]||{},y=2),"object"!=typeof d&&"function"!==r(d)&&(d={}),m===y&&(d=this,--y);y<m;y++)if(null!=(a=h[y]))for(t in a)i=d[t],d!==(o=a[t])&&(u&&o&&(s(o)||(n=Array.isArray(o)))?(n?(n=!1,l=i&&Array.isArray(i)?i:[]):l=i&&s(i)?i:{},d[t]=e(u,l,o)):void 0!==o&&(d[t]=o));return d};var o=e,n=["hp","atk","def","spa","spd","spe"],l=n,h=n,c=n,d=n,y=n,u=n,m=n;e.STATS=[[],["hp","atk","def","spc","spe"],n,l,h,c,d,y,u,m];var p=["Fighting","Flying","Poison","Ground","Rock","Bug","Ghost","Steel","Fire","Water","Grass","Electric","Psychic","Ice","Dragon","Dark"],b={Bug:{ivs:{atk:30,def:30,spd:30},dvs:{atk:13,def:13}},Dark:{ivs:{},dvs:{}},Dragon:{ivs:{atk:30},dvs:{def:14}},Electric:{ivs:{spa:30},dvs:{atk:14}},Fighting:{ivs:{def:30,spa:30,spd:30,spe:30},dvs:{atk:12,def:12}},Fire:{ivs:{atk:30,spa:30,spe:30},dvs:{atk:14,def:12}},Flying:{ivs:{hp:30,atk:30,def:30,spa:30,spd:30},dvs:{atk:12,def:13}},Ghost:{ivs:{def:30,spd:30},dvs:{atk:13,def:14}},Grass:{ivs:{atk:30,spa:30},dvs:{atk:14,def:14}},Ground:{ivs:{spa:30,spd:30},dvs:{atk:12}},Ice:{ivs:{atk:30,def:30},dvs:{def:13}},Poison:{ivs:{def:30,spa:30,spd:30},dvs:{atk:12,def:14}},Psychic:{ivs:{atk:30,spe:30},dvs:{def:12}},Rock:{ivs:{def:30,spd:30,spe:30},dvs:{atk:13,def:12}},Steel:{ivs:{spd:30},dvs:{atk:13}},Water:{ivs:{atk:30,def:30,spa:30},dvs:{atk:14,def:13}}};e.Stats=new(function(){function a(){}return a.prototype.displayStat=function(e){switch(e){case"hp":return"HP";case"atk":return"Atk";case"def":return"Def";case"spa":return"SpA";case"spd":return"SpD";case"spe":return"Spe";case"spc":return"Spc";default:throw new Error("unknown stat ".concat(e))}},a.prototype.shortForm=function(e){switch(e){case"hp":return"hp";case"atk":return"at";case"def":return"df";case"spa":return"sa";case"spd":return"sd";case"spe":return"sp";case"spc":return"sl"}},a.prototype.getHPDV=function(e){return this.IVToDV(e.atk)%2*8+this.IVToDV(e.def)%2*4+this.IVToDV(e.spe)%2*2+this.IVToDV(e.spc)%2},a.prototype.IVToDV=function(e){return Math.floor(e/2)},a.prototype.DVToIV=function(e){return 2*e},a.prototype.DVsToIVs=function(a){var t,i={};for(t in a)i[t]=e.Stats.DVToIV(a[t]);return i},a.prototype.calcStat=function(e,a,t,i,r,s,o){if(e.num<1||e.num>9)throw new Error("Invalid generation ".concat(e.num));return e.num<3?this.calcStatRBY(a,t,i,s):this.calcStatADV(e.natures,a,t,i,r,s,o)},a.prototype.calcStatADV=function(e,a,t,i,r,s,n){if("hp"===a)return 1===t?t:Math.floor((2*t+i+Math.floor(r/4))*s/100)+s+10;var l=[void 0,void 0];if(n){var h=e.get((0,o.toID)(n));l=[null==h?void 0:h.plus,null==h?void 0:h.minus]}var c=l[0]===a&&l[1]===a?1:l[0]===a?1.1:l[1]===a?.9:1;return Math.floor((Math.floor((2*t+i+Math.floor(r/4))*s/100)+5)*c)},a.prototype.calcStatRBY=function(e,a,t,i){return this.calcStatRBYFromDV(e,a,this.IVToDV(t),i)},a.prototype.calcStatRBYFromDV=function(e,a,t,i){return"hp"===e?Math.floor((2*(a+t)+63)*i/100)+i+10:Math.floor((2*(a+t)+63)*i/100)+5},a.prototype.getHiddenPowerIVs=function(a,t){var i=b[t];if(i)return 2===a.num?e.Stats.DVsToIVs(i.dvs):i.ivs},a.prototype.getHiddenPower=function(e,a){var t=function(e,a){return void 0===a&&(a=0),a?(e>>>0)%Math.pow(2,a):e>>>0};if(e.num<=2){var i=t(a.atk/2),r=t(a.def/2),s=t(a.spe/2),o=t(a.spa/2);return{type:p[i%4*4+r%4],power:t((5*((o>>3)+2*(s>>3)+4*(r>>3)+8*(i>>3))+o%4)/2+31)}}var n=0,l=0,h=1;for(var c in{hp:31,atk:31,def:31,spe:31,spa:31,spd:31})n+=h*(a[c]%2),l+=h*(t(a[c]/2)%2),h*=2;return{type:p[t(15*n/63)],power:e.num&&e.num<6?t(40*l/63)+30:60}},a}());var f=e,g=_this&&_this.__assign||function(){return g=Object.assign||function(e){for(var a,t=1,i=arguments.length;t<i;t++)for(var r in a=arguments[t])Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r]);return e},g.apply(this,arguments)},S=_this&&_this.__values||function(e){var a="function"==typeof Symbol&&Symbol.iterator,t=a&&e[a],i=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")},v=["hp","atk","def","spa","spd","spe"],A=new Set(["spc"]),k=function(){function e(a,t,i){var r,s,n;void 0===i&&(i={}),this.species=(0,o.extend)(!0,{},a.species.get((0,o.toID)(t)),i.overrides),this.gen=a,this.name=i.name||t,this.types=this.species.types,this.weightkg=this.species.weightkg,this.level=i.level||100,this.gender=i.gender||this.species.gender||"M",this.ability=i.ability||(null===(n=this.species.abilities)||void 0===n?void 0:n[0])||void 0,this.abilityOn=!!i.abilityOn,this.isDynamaxed=!!i.isDynamaxed,this.dynamaxLevel=this.isDynamaxed?void 0===i.dynamaxLevel?10:i.dynamaxLevel:void 0,this.isSaltCure=!!i.isSaltCure,this.alliesFainted=i.alliesFainted,this.boostedStat=i.boostedStat,this.teraType=i.teraType,this.item=i.item,this.nature=i.nature||"Serious",this.ivs=e.withDefault(a,i.ivs,31),this.evs=e.withDefault(a,i.evs,a.num>=3?0:252),this.boosts=e.withDefault(a,i.boosts,0,!1),0===this.weightkg&&!this.isDynamaxed&&this.species.baseSpecies&&(this.weightkg=a.species.get((0,o.toID)(this.species.baseSpecies)).weightkg),a.num<3&&(this.ivs.hp=f.Stats.DVToIV(f.Stats.getHPDV({atk:this.ivs.atk,def:this.ivs.def,spe:this.ivs.spe,spc:this.ivs.spa}))),this.rawStats={},this.stats={};try{for(var l=S(v),h=l.next();!h.done;h=l.next()){var c=h.value,d=this.calcStat(a,c);this.rawStats[c]=d,this.stats[c]=d}}catch(e){r={error:e}}finally{try{h&&!h.done&&(s=l.return)&&s.call(l)}finally{if(r)throw r.error}}var y=i.curHP||i.originalCurHP;this.originalCurHP=y&&y<=this.rawStats.hp?y:this.rawStats.hp,this.status=i.status||"",this.toxicCounter=i.toxicCounter||0,this.moves=i.moves||[]}return e.prototype.maxHP=function(e){return void 0===e&&(e=!1),!e&&this.isDynamaxed&&1!==this.species.baseStats.hp?Math.floor(this.rawStats.hp*(150+5*this.dynamaxLevel)/100):this.rawStats.hp},e.prototype.curHP=function(e){return void 0===e&&(e=!1),!e&&this.isDynamaxed&&1!==this.species.baseStats.hp?Math.ceil(this.originalCurHP*(150+5*this.dynamaxLevel)/100):this.originalCurHP},e.prototype.hasAbility=function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return!(!this.ability||!e.includes(this.ability))},e.prototype.hasItem=function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return!(!this.item||!e.includes(this.item))},e.prototype.hasStatus=function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return!(!this.status||!e.includes(this.status))},e.prototype.hasType=function(){for(var e,a,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];try{for(var r=S(t),s=r.next();!s.done;s=r.next()){var o=s.value;if(this.teraType?this.teraType===o:this.types.includes(o))return!0}}catch(a){e={error:a}}finally{try{s&&!s.done&&(a=r.return)&&a.call(r)}finally{if(e)throw e.error}}return!1},e.prototype.hasOriginalType=function(){for(var e,a,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];try{for(var r=S(t),s=r.next();!s.done;s=r.next()){var o=s.value;if(this.types.includes(o))return!0}}catch(a){e={error:a}}finally{try{s&&!s.done&&(a=r.return)&&a.call(r)}finally{if(e)throw e.error}}return!1},e.prototype.named=function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return e.includes(this.name)},e.prototype.clone=function(){return new e(this.gen,this.name,{level:this.level,ability:this.ability,abilityOn:this.abilityOn,isDynamaxed:this.isDynamaxed,dynamaxLevel:this.dynamaxLevel,isSaltCure:this.isSaltCure,alliesFainted:this.alliesFainted,boostedStat:this.boostedStat,item:this.item,gender:this.gender,nature:this.nature,ivs:(0,o.extend)(!0,{},this.ivs),evs:(0,o.extend)(!0,{},this.evs),boosts:(0,o.extend)(!0,{},this.boosts),originalCurHP:this.originalCurHP,status:this.status,teraType:this.teraType,toxicCounter:this.toxicCounter,moves:this.moves.slice(),overrides:this.species})},e.prototype.calcStat=function(e,a){return f.Stats.calcStat(e,a,this.species.baseStats[a],this.ivs[a],this.evs[a],this.level,this.nature)},e.getForme=function(e,a,t,i){var r=e.species.get((0,o.toID)(a));if(!(null==r?void 0:r.otherFormes))return a;var s=0;return t&&(t.includes("ite")&&!t.includes("ite Y")||"Groudon"===a&&"Red Orb"===t||"Kyogre"===a&&"Blue Orb"===t)||i&&"Meloetta"===a&&"Relic Song"===i||"Rayquaza"===a&&"Dragon Ascent"===i?s=1:(null==t?void 0:t.includes("ite Y"))&&(s=2),s?r.otherFormes[s-1]:r.name},e.withDefault=function(e,a,t,i){void 0===i&&(i=!0);var r={};if(a&&((0,o.assignWithout)(r,a,A),a.spc&&(r.spa=a.spc,r.spd=a.spc),i&&e.num<=2&&a.spa!==a.spd))throw new Error("Special Attack and Special Defense must match before Gen 3");return g({hp:t,atk:t,def:t,spa:t,spd:t,spe:t},r)},e}();e.Pokemon=k;var P=_this&&_this.__read||function(e,a){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var i,r,s=t.call(e),o=[];try{for(;(void 0===a||a-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(e){r={error:e}}finally{try{i&&!i.done&&(t=s.return)&&t.call(s)}finally{if(r)throw r.error}}return o},M=function(){function e(e){void 0===e&&(e={}),this.gameType=e.gameType||"Singles",this.terrain=e.terrain,this.weather=e.weather,this.isMagicRoom=!!e.isMagicRoom,this.isWonderRoom=!!e.isWonderRoom,this.isMysteryRoom=!!e.isMysteryRoom,this.isGravity=!!e.isGravity,this.isAuraBreak=e.isAuraBreak||!1,this.isFairyAura=e.isFairyAura||!1,this.isDarkAura=e.isDarkAura||!1,this.isBeadsOfRuin=e.isBeadsOfRuin||!1,this.isSwordOfRuin=e.isSwordOfRuin||!1,this.isTabletsOfRuin=e.isTabletsOfRuin||!1,this.isVesselOfRuin=e.isVesselOfRuin||!1,this.attackerSide=new T(e.attackerSide||{}),this.defenderSide=new T(e.defenderSide||{})}return e.prototype.hasWeather=function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return!(!this.weather||!e.includes(this.weather))},e.prototype.hasTerrain=function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return!(!this.terrain||!e.includes(this.terrain))},e.prototype.swap=function(){var e;return e=P([this.defenderSide,this.attackerSide],2),this.attackerSide=e[0],this.defenderSide=e[1],this},e.prototype.clone=function(){return new e({gameType:this.gameType,weather:this.weather,terrain:this.terrain,isMagicRoom:this.isMagicRoom,isWonderRoom:this.isWonderRoom,isMysteryRoom:this.isMysteryRoom,isGravity:this.isGravity,attackerSide:this.attackerSide,defenderSide:this.defenderSide,isAuraBreak:this.isAuraBreak,isDarkAura:this.isDarkAura,isFairyAura:this.isFairyAura,isBeadsOfRuin:this.isBeadsOfRuin,isSwordOfRuin:this.isSwordOfRuin,isTabletsOfRuin:this.isTabletsOfRuin,isVesselOfRuin:this.isVesselOfRuin})},e}();e.Field=M;var T=function(){function e(e){void 0===e&&(e={}),this.spikes=e.spikes||0,this.steelsurge=!!e.steelsurge,this.vinelash=!!e.vinelash,this.wildfire=!!e.wildfire,this.cannonade=!!e.cannonade,this.volcalith=!!e.volcalith,this.isSR=!!e.isSR,this.isReflect=!!e.isReflect,this.isLightScreen=!!e.isLightScreen,this.isProtected=!!e.isProtected,this.isSeeded=!!e.isSeeded,this.isForesight=!!e.isForesight,this.isMiracleEye=!!e.isMiracleEye,this.isTailwind=!!e.isTailwind,this.isHelpingHand=!!e.isHelpingHand,this.isFlowerGift=!!e.isFlowerGift,this.isFriendGuard=!!e.isFriendGuard,this.isAuroraVeil=!!e.isAuroraVeil,this.isBattery=!!e.isBattery,this.isPowerSpot=!!e.isPowerSpot,this.isSwitching=e.isSwitching}return e.prototype.clone=function(){return new e(this)},e}();e.Side=T;var w=["Fire","Water","Grass","Electric","Ice","Psychic","Dark","Dragon"],B=function(){function e(e,a,t){var i,r;void 0===t&&(t={}),a=t.name||a,this.originalName=a;var s=(0,o.extend)(!0,{name:a},e.moves.get((0,o.toID)(a)),t.overrides);if(this.hits=1,t.useMax&&s.maxMove){var n=R(s.type,t.species,!("Status"!==s.category),t.ability),l=e.moves.get((0,o.toID)(n));s=(0,o.extend)(!0,{},l,{name:n,basePower:["G-Max Drum Solo","G-Max Fire Ball","G-Max Hydrosnipe"].includes(n)?160:10===l.basePower||"Max Flare"===n?s.maxMove.basePower:l.basePower,category:s.category})}if(t.useZ&&(null===(i=s.zMove)||void 0===i?void 0:i.basePower)){var h=F(s.name,s.type,t.item),c=e.moves.get((0,o.toID)(h));s=(0,o.extend)(!0,{},c,{name:h,basePower:1===c.basePower?s.zMove.basePower:c.basePower,category:s.category})}else s.multihit&&("number"==typeof s.multihit?this.hits=s.multihit:t.hits?this.hits=t.hits:this.hits="Skill Link"===t.ability?s.multihit[1]:s.multihit[0]+1),this.timesUsedWithMetronome=t.timesUsedWithMetronome;this.gen=e,this.name=s.name,this.ability=t.ability,this.item=t.item,this.useZ=t.useZ,this.useMax=t.useMax,this.overrides=t.overrides,this.species=t.species,this.bp=s.basePower;var d=e.num>=2&&"struggle"===s.id||e.num<=4&&["futuresight","doomdesire"].includes(s.id);this.type=d?"???":s.type,this.category=s.category||(e.num<4?w.includes(s.type)?"Special":"Physical":"Status");var y="Special"===this.category?"spa":"atk";(null===(r=s.self)||void 0===r?void 0:r.boosts)&&s.self.boosts[y]&&s.self.boosts[y]<0&&(this.dropsStats=Math.abs(s.self.boosts[y])),this.timesUsed=this.dropsStats&&t.timesUsed||1,this.secondaries=s.secondaries,this.target=s.target||"any",this.recoil=s.recoil,this.hasCrashDamage=!!s.hasCrashDamage,this.mindBlownRecoil=!!s.mindBlownRecoil,this.struggleRecoil=!!s.struggleRecoil,this.isCrit=!!t.isCrit||!!s.willCrit||1===e.num&&["crabhammer","razorleaf","slash","karate chop"].includes(s.id),this.isStellarFirstUse=!!t.isStellarFirstUse,this.drain=s.drain,this.flags=s.flags,this.priority=s.priority||0,this.ignoreDefensive=!!s.ignoreDefensive,this.overrideOffensiveStat=s.overrideOffensiveStat,this.overrideDefensiveStat=s.overrideDefensiveStat,this.overrideOffensivePokemon=s.overrideOffensivePokemon,this.overrideDefensivePokemon=s.overrideDefensivePokemon,this.breaksProtect=!!s.breaksProtect,this.isZ=!!s.isZ,this.isMax=!!s.isMax,this.bp||["return","frustration","pikapapow","veeveevolley"].includes(s.id)&&(this.bp=102)}return e.prototype.named=function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return e.includes(this.name)},e.prototype.hasType=function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return e.includes(this.type)},e.prototype.clone=function(){return new e(this.gen,this.originalName,{ability:this.ability,item:this.item,species:this.species,useZ:this.useZ,useMax:this.useMax,isCrit:this.isCrit,isStellarFirstUse:this.isStellarFirstUse,hits:this.hits,timesUsed:this.timesUsed,timesUsedWithMetronome:this.timesUsedWithMetronome,overrides:this.overrides})},e}();function F(e,a,t){if(t=t||"",e.includes("Hidden Power"))return"Breakneck Blitz";if("Clanging Scales"===e&&"Kommonium Z"===t)return"Clangorous Soulblaze";if("Darkest Lariat"===e&&"Incinium Z"===t)return"Malicious Moonsault";if("Giga Impact"===e&&"Snorlium Z"===t)return"Pulverizing Pancake";if("Moongeist Beam"===e&&"Lunalium Z"===t)return"Menacing Moonraze Maelstrom";if("Photon Geyser"===e&&"Ultranecrozium Z"===t)return"Light That Burns the Sky";if("Play Rough"===e&&"Mimikium Z"===t)return"Let's Snuggle Forever";if("Psychic"===e&&"Mewnium Z"===t)return"Genesis Supernova";if("Sparkling Aria"===e&&"Primarium Z"===t)return"Oceanic Operetta";if("Spectral Thief"===e&&"Marshadium Z"===t)return"Soul-Stealing 7-Star Strike";if("Spirit Shackle"===e&&"Decidium Z"===t)return"Sinister Arrow Raid";if("Stone Edge"===e&&"Lycanium Z"===t)return"Splintered Stormshards";if("Sunsteel Strike"===e&&"Solganium Z"===t)return"Searing Sunraze Smash";if("Volt Tackle"===e&&"Pikanium Z"===t)return"Catastropika";if("Nature's Madness"===e&&"Tapunium Z"===t)return"Guardian of Alola";if("Thunderbolt"===e){if("Aloraichium Z"===t)return"Stoked Sparksurfer";if("Pikashunium Z"===t)return"10,000,000 Volt Thunderbolt"}return x[a]}e.Move=B,e.getZMoveName=F;var x={Bug:"Savage Spin-Out",Dark:"Black Hole Eclipse",Dragon:"Devastating Drake",Electric:"Gigavolt Havoc",Fairy:"Twinkle Tackle",Fighting:"All-Out Pummeling",Fire:"Inferno Overdrive",Flying:"Supersonic Skystrike",Ghost:"Never-Ending Nightmare",Grass:"Bloom Doom",Ground:"Tectonic Rage",Ice:"Subzero Slammer",Normal:"Breakneck Blitz",Poison:"Acid Downpour",Psychic:"Shattered Psyche",Rock:"Continental Crush",Steel:"Corkscrew Crash",Water:"Hydro Vortex"};function R(e,a,t,i){if(t)return"Max Guard";if("Normalize"===i)return"Max Strike";if("Fire"===e){if("Charizard-Gmax"===a)return"G-Max Wildfire";if("Centiskorch-Gmax"===a)return"G-Max Centiferno";if("Cinderace-Gmax"===a)return"G-Max Fire Ball"}if("Normal"===e){if("Eevee-Gmax"===a)return"G-Max Cuddle";if("Meowth-Gmax"===a)return"G-Max Gold Rush";if("Snorlax-Gmax"===a)return"G-Max Replenish";if("Pixilate"===i)return"Max Starfall";if("Aerilate"===i)return"Max Airstream";if("Refrigerate"===i)return"Max Hailstorm";if("Galvanize"===i)return"Max Lightning"}if("Fairy"===e){if("Alcremie-Gmax"===a)return"G-Max Finale";if("Hatterene-Gmax"===a)return"G-Max Smite"}if("Steel"===e){if("Copperajah-Gmax"===a)return"G-Max Steelsurge";if("Melmetal-Gmax"===a)return"G-Max Meltdown"}if("Electric"===e){if("Pikachu-Gmax"===a)return"G-Max Volt Crash";if((null==a?void 0:a.startsWith("Toxtricity"))&&(null==a?void 0:a.endsWith("Gmax")))return"G-Max Stun Shock"}if("Grass"===e){if("Appletun-Gmax"===a)return"G-Max Sweetness";if("Flapple-Gmax"===a)return"G-Max Tartness";if("Rillaboom-Gmax"===a)return"G-Max Drum Solo";if("Venusaur-Gmax"===a)return"G-Max Vine Lash"}if("Water"===e){if("Blastoise-Gmax"===a)return"G-Max Cannonade";if("Drednaw-Gmax"===a)return"G-Max Stonesurge";if("Inteleon-Gmax"===a)return"G-Max Hydrosnipe";if("Kingler-Gmax"===a)return"G-Max Foam Burst";if("Urshifu-Rapid-Strike-Gmax"===a)return"G-Max Rapid Flow"}if("Dark"===e){if("Grimmsnarl-Gmax"===a)return"G-Max Snooze";if("Urshifu-Gmax"===a)return"G-Max One Blow"}return"Poison"===e&&"Garbodor-Gmax"===a?"G-Max Malodor":"Fighting"===e&&"Machamp-Gmax"===a?"G-Max Chi Strike":"Ghost"===e&&"Gengar-Gmax"===a?"G-Max Terror":"Ice"===e&&"Lapras-Gmax"===a?"G-Max Resonance":"Flying"===e&&"Corviknight-Gmax"===a?"G-Max Wind Rage":"Dragon"===e&&"Duraludon-Gmax"===a?"G-Max Depletion":"Psychic"===e&&"Orbeetle-Gmax"===a?"G-Max Gravitas":"Rock"===e&&"Coalossal-Gmax"===a?"G-Max Volcalith":"Ground"===e&&"Sandaconda-Gmax"===a?"G-Max Sandblast":"Dark"===e&&"Grimmsnarl-Gmax"===a?"G-Max Snooze":"Max "+G[e]}e.getMaxMoveName=R;var G={Bug:"Flutterby",Dark:"Darkness",Dragon:"Wyrmwind",Electric:"Lightning",Fairy:"Starfall",Fighting:"Knuckle",Fire:"Flare",Flying:"Airstream",Ghost:"Phantasm",Grass:"Overgrowth",Ground:"Quake",Ice:"Hailstorm",Normal:"Strike",Poison:"Ooze",Psychic:"Mindstorm",Rock:"Rockfall",Steel:"Steelspike",Water:"Geyser"};e.SEED_BOOSTED_STAT={"Electric Seed":"def","Grassy Seed":"def","Misty Seed":"spd","Psychic Seed":"spd"},e.getItemBoostType=function(e){switch(e){case"Draco Plate":case"Dragon Fang":return"Dragon";case"Dread Plate":case"Black Glasses":return"Dark";case"Earth Plate":case"Soft Sand":return"Ground";case"Fist Plate":case"Black Belt":return"Fighting";case"Flame Plate":case"Charcoal":return"Fire";case"Icicle Plate":case"Never-Melt Ice":return"Ice";case"Insect Plate":case"Silver Powder":return"Bug";case"Iron Plate":case"Metal Coat":return"Steel";case"Meadow Plate":case"Rose Incense":case"Miracle Seed":return"Grass";case"Mind Plate":case"Odd Incense":case"Twisted Spoon":return"Psychic";case"Fairy Feather":case"Pixie Plate":return"Fairy";case"Sky Plate":case"Sharp Beak":return"Flying";case"Splash Plate":case"Sea Incense":case"Wave Incense":case"Mystic Water":return"Water";case"Spooky Plate":case"Spell Tag":return"Ghost";case"Stone Plate":case"Rock Incense":case"Hard Stone":return"Rock";case"Toxic Plate":case"Poison Barb":return"Poison";case"Zap Plate":case"Magnet":return"Electric";case"Silk Scarf":case"Pink Bow":case"Polkadot Bow":return"Normal";default:return}},e.getBerryResistType=function(e){switch(e){case"Chilan Berry":return"Normal";case"Occa Berry":return"Fire";case"Passho Berry":return"Water";case"Wacan Berry":return"Electric";case"Rindo Berry":return"Grass";case"Yache Berry":return"Ice";case"Chople Berry":return"Fighting";case"Kebia Berry":return"Poison";case"Shuca Berry":return"Ground";case"Coba Berry":return"Flying";case"Payapa Berry":return"Psychic";case"Tanga Berry":return"Bug";case"Charti Berry":return"Rock";case"Kasib Berry":return"Ghost";case"Haban Berry":return"Dragon";case"Colbur Berry":return"Dark";case"Babiri Berry":return"Steel";case"Roseli Berry":return"Fairy";default:return}};var I=new Set(["TR24","TR28","TR34","TR39","TR53","TR55","TR64","TR66","TR72","TR73"]),D=new Set(["Hard Stone","Room Service","Claw Fossil","Dome Fossil","Helix Fossil","Old Amber","Root Fossil","Armor Fossil","Old Amber","Fossilized Bird","Fossilized Dino","Fossilized Drake","Fossilized Fish","Plume Fossil","Jaw Fossil","Cover Fossil","Sail Fossil","Rare Bone","Skull Fossil","TR10","TR31","TR75"]),H=new Set(["Deep Sea Tooth","Thick Club","TR02","TR04","TR05","TR08","TR11","TR22","TR35","TR42","TR45","TR50","TR61","TR65","TR67","TR86","TR90","TR96"]),W=new Set(["TR01","TR41","TR62","TR93","TR97","TR98"]),C=new Set(["Assault Vest","Blunder Policy","Chipped Pot","Cracked Pot","Heavy-Duty Boots","Weakness Policy","Quick Claw","Dawn Stone","Dusk Stone","Electirizer","Magmarizer","Oval Stone","Protector","Sachet","Whipped Dream","Razor Claw","Shiny Stone","TR16","TR18","TR19","TR25","TR32","TR33","TR47","TR56","TR57","TR58","TR59","TR60","TR63","TR69","TR70","TR74","TR84","TR87","TR92","TR95","TR99"]),O=new Set(["Poison Barb","Dragon Fang","Power Anklet","Power Band","Power Belt","Power Bracer","Power Lens","Power Weight"]),E=new Set(["Adamant Orb","Damp Rock","Heat Rock","Leek","Lustrous Orb","Macho Brace","Rocky Helmet","Stick","Utility Umbrella","Terrain Extender"]),V=new Set(["Absorb Bulb","Black Belt","Black Sludge","Black Glasses","Cell Battery","Charcoal","Deep Sea Scale","Flame Orb","King's Rock","Life Orb","Light Ball","Light Clay","Magnet","Metal Coat","Miracle Seed","Mystic Water","Never-Melt Ice","Razor Fang","Scope Lens","Soul Dew","Spell Tag","Sweet Apple","Tart Apple","Throat Spray","Toxic Orb","Twisted Spoon","Dragon Scale","Energy Powder","Fire Stone","Leaf Stone","Moon Stone","Sun Stone","Thunder Stone","Up-Grade","Water Stone","Berry Juice","Black Sludge","Prism Scale","Ice Stone","Gold Bottle Cap","Luminous Moss","Eject Button","Snowball","Bottle Cap"]),L=new Set(["Air Balloon","Berry Sweet","Choice Band","Choice Scarf","Choice Specs","Clover Sweet","Destiny Knot","Electric Seed","Expert Belt","Flower Sweet","Focus Band","Focus Sash","Full Incense","Grassy Seed","Lagging Tail","Lax Incense","Leftovers","Love Sweet","Mental Herb","Metal Powder","Mint Berry","Miracle Berry","Misty Seed","Muscle Band","Power Herb","Psychic Seed","Odd Incense","Quick Powder","Reaper Cloth","Red Card","Ribbon Sweet","Ring Target","Rock Incense","Rose Incense","Sea Incense","Shed Shell","Silk Scarf","Silver Powder","Smooth Rock","Soft Sand","Soothe Bell","Star Sweet","Strawberry Sweet","Wave Incense","White Herb","Wide Lens","Wise Glasses","Zoom Lens","Silver Powder","Power Herb","TR00","TR07","TR12","TR13","TR14","TR17","TR20","TR21","TR23","TR26","TR27","TR29","TR30","TR37","TR38","TR40","TR44","TR46","TR48","TR49","TR51","TR52","TR54","TR68","TR76","TR77","TR79","TR80","TR83","TR85","TR88","TR91"]);e.getFlingPower=function(e){return e?["Big Nugget","Iron Ball","TR43","TR71"].includes(e)?130:I.has(e)?85:["TR03","TR06","TR09","TR15","TR89"].includes(e)?110:D.has(e)?100:["TR36","TR78","TR81","TR94"].includes(e)?95:e.includes("Plate")||H.has(e)?90:W.has(e)?85:C.has(e)?80:O.has(e)?70:E.has(e)?60:["Eject Pack","Sharp Beak","Dubious Disc"].includes(e)?50:["Icy Rock","Eviolite","Lucky Punch"].includes(e)?40:V.has(e)?30:"TR82"===e?20:e.includes("Berry")||L.has(e)?10:0:0},e.getNaturalGift=function(e,a){var t,i=null===(t=e.items.get((0,o.toID)(a)))||void 0===t?void 0:t.naturalGift;return i?{t:i.type,p:i.basePower}:{t:"Normal",p:1}},e.getTechnoBlast=function(e){switch(e){case"Burn Drive":return"Fire";case"Chill Drive":return"Ice";case"Douse Drive":return"Water";case"Shock Drive":return"Electric";default:return}},e.getMultiAttack=function(e){if(e.includes("Memory"))return e.substring(0,e.indexOf(" "))},e.getOrbType=function(e){switch(e){case"Red Orb":case"Cerise Orb":return"Fire";case"Blue Orb":case"Teal Orb":return"Water";default:return"Normal"}};var N=_this&&_this.__spreadArray||function(e,a,t){if(t||2===arguments.length)for(var i,r=0,s=a.length;r<s;r++)!i&&r in a||(i||(i=Array.prototype.slice.call(a,0,r)),i[r]=a[r]);return e.concat(i||Array.prototype.slice.call(a))},U=["Macho Brace","Power Anklet","Power Band","Power Belt","Power Bracer","Power Lens","Power Weight"];function z(e,a,t){if(t&&t.num<3){if(a>=0){e=Math.floor(e*[1,1.5,2,2.5,3,3.5,4][a])}else{e=Math.floor(e*[100,66,50,40,33,28,25][-a]/100)}return Math.min(999,Math.max(1,e))}var i=[[2,8],[2,7],[2,6],[2,5],[2,4],[2,3],[2,2],[3,2],[4,2],[5,2],[6,2],[7,2],[8,2]];return e=Y(e*i[6+a][0]),e=Math.floor(e/i[6+a][1])}function K(e,a,t,i){var r=t.weather||"",s=t.terrain,o=z(a.rawStats.spe,a.boosts.spe,e),n=[];return i.isTailwind&&n.push(8192),a.hasAbility("Unburden")&&a.abilityOn||a.hasAbility("Chlorophyll")&&r.includes("Sun")||a.hasAbility("Sand Rush")&&"Sand"===r||a.hasAbility("Swift Swim")&&r.includes("Rain")||a.hasAbility("Toxcceleration")&&r.includes("Miasma")||a.hasAbility("Slush Rush")&&["Hail","Snow"].includes(r)||a.hasAbility("Surge Surfer")&&"Electric"===s?n.push(8192):a.hasAbility("Quick Feet")&&a.status?n.push(6144):a.hasAbility("Slow Start")&&a.abilityOn?n.push(2048):_(a,t)&&"spe"===j(a,e)&&n.push(6144),a.hasItem("Choice Scarf")?n.push(6144):a.hasItem.apply(a,N(["Iron Ball"],P(U),!1))?n.push(2048):a.hasItem("Quick Powder")&&a.named("Ditto")&&n.push(8192),o=q(Q(o*Z(n,410,131172)/4096)),a.hasStatus("par")&&!a.hasAbility("Quick Feet")&&(o=Math.floor(q(o*(e.num<7?25:50))/100)),o=Math.min(e.num<=2?999:1e4,o),Math.max(0,o)}function Z(e,a,t){var i,r,s=4096;try{for(var o=S(e),n=o.next();!n.done;n=o.next()){var l=n.value;4096!==l&&(s=s*l+2048>>12)}}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return Math.max(Math.min(s,t),a)}function j(e,a){var t,i;if(e.boostedStat&&"auto"!==e.boostedStat)return e.boostedStat;var r="atk";try{for(var s=S(["def","spa","spd","spe"]),o=s.next();!o.done;o=s.next()){var n=o.value;z(e.rawStats[n],e.boosts[n],a)>z(e.rawStats[r],e.boosts[r],a)&&(r=n)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(t)throw t.error}}return r}function _(e,a){if(!e.boostedStat)return!1;var t=a.weather||"",i=a.terrain;return e.hasAbility("Protosynthesis")&&(t.includes("Sun")||e.hasItem("Booster Energy"))||e.hasAbility("Quark Drive")&&("Electric"===i||e.hasItem("Booster Energy"))||"auto"!==e.boostedStat}function Q(e){return e%1>.5?Math.ceil(e):Math.floor(e)}function Y(e){return e>65535?e%65536:e}function q(e){return e>4294967295?e%4294967296:e}e.isGrounded=function(e,a){return a.isGravity||e.hasItem("Iron Ball")||!e.hasType("Flying")&&!e.hasAbility("Levitate")&&!e.hasItem("Air Balloon")},e.getModifiedStat=z,e.computeFinalStats=function(e,a,t,i){for(var r,s,o,n,l=[],h=4;h<arguments.length;h++)l[h-4]=arguments[h];var c=[[a,i.attackerSide],[t,i.defenderSide]];try{for(var d=S(c),y=d.next();!y.done;y=d.next()){var u=P(y.value,2),m=u[0],p=u[1];try{for(var b=(o=void 0,S(l)),f=b.next();!f.done;f=b.next()){var g=f.value;"spe"===g?m.stats.spe=K(e,m,i,p):m.stats[g]=z(m.rawStats[g],m.boosts[g],e)}}catch(e){o={error:e}}finally{try{f&&!f.done&&(n=b.return)&&n.call(b)}finally{if(o)throw o.error}}}}catch(e){r={error:e}}finally{try{y&&!y.done&&(s=d.return)&&s.call(d)}finally{if(r)throw r.error}}},e.getFinalSpeed=K,e.getMoveEffectiveness=function(e,a,t,i,r,s,n,l){return i&&"Ghost"===t&&a.hasType("Normal","Fighting")||r&&"Dark"===t&&a.hasType("Psychic")||(n||s)&&"Flying"===t&&a.hasType("Ground")||l&&("Ghost"===t&&a.hasType("Normal")||"Flying"===t&&a.hasType("Ground")||"Normal"===t&&a.hasType("Ghost"))?1:a.named("Freeze-Dry","Ice Drill")&&"Water"===t||a.named("Power Outage")&&"Electric"===t||a.named("Rockjaw")&&"Ground"===t||a.named("Vaporize")&&"Water"===t||a.named("Venus Chomp")&&"Bug"===t?2:a.named("Flying Press")?e.types.get("fighting").effectiveness[t]*e.types.get("flying").effectiveness[t]:n&&0===e.types.get((0,o.toID)(a.type)).effectiveness[t]?1:e.types.get((0,o.toID)(a.type)).effectiveness[t]},e.checkAirLock=function(e,a){e.hasAbility("Air Lock","Cloud Nine")&&(a.weather=void 0)},e.checkTeraformZero=function(e,a){e.hasAbility("Teraform Zero")&&e.abilityOn&&(a.weather=void 0,a.terrain=void 0)},e.checkForecast=function(e,a){if(e.hasAbility("Forecast")&&e.named("Castform"))switch(a){case"Sun":case"Harsh Sunshine":e.types=["Fire"];break;case"Rain":case"Heavy Rain":e.types=["Water"];break;case"Hail":case"Snow":e.types=["Ice"];break;default:e.types=["Normal"]}},e.checkItem=function(e,a){4===e.gen.num&&e.hasItem("Iron Ball")||(e.hasAbility("Klutz")&&!U.includes(e.item)||a)&&(e.item="")},e.checkWonderRoom=function(e,a){var t;a&&(t=P([e.rawStats.spd,e.rawStats.def],2),e.rawStats.def=t[0],e.rawStats.spd=t[1])},e.checkIntimidate=function(e,a,t){var i=t.hasAbility("Clear Body","White Smoke","Hyper Cutter","Full Metal Body")||e.num>=8&&t.hasAbility("Inner Focus","Own Tempo","Oblivious","Scrappy")||t.hasItem("Clear Amulet");a.hasAbility("Intimidate")&&a.abilityOn&&!i&&(t.hasAbility("Contrary","Defiant","Guard Dog")?t.boosts.atk=Math.min(6,t.boosts.atk+1):t.hasAbility("Simple")?t.boosts.atk=Math.max(-6,t.boosts.atk-2):t.boosts.atk=Math.max(-6,t.boosts.atk-1),t.hasAbility("Competitive")&&(t.boosts.spa=Math.min(6,t.boosts.spa+2)))},e.checkDownload=function(e,a,t){var i;if(e.hasAbility("Download")&&e.abilityOn){var r=a.stats.def,s=a.stats.spd;t&&(r=(i=P([s,r],2))[0],s=i[1]),s<=r?e.boosts.spa=Math.min(6,e.boosts.spa+1):e.boosts.atk=Math.min(6,e.boosts.atk+1)}},e.checkSearchEngine=function(e,a){e.hasAbility("Search Engine")&&e.abilityOn&&(a.stats.atk>=a.stats.spa?e.boosts.def=Math.min(6,e.boosts.def+1):e.boosts.spd=Math.min(6,e.boosts.spd+1))},e.checkInflate=function(e){e.hasAbility("Inflate")&&e.abilityOn&&(e.boosts.def=Math.min(6,e.boosts.def+1))},e.checkIntrepidSword=function(e,a){e.hasAbility("Intrepid Sword")&&a.num>7&&(e.boosts.atk=Math.min(6,e.boosts.atk+1))},e.checkDauntlessShield=function(e,a){e.hasAbility("Dauntless Shield")&&a.num>7&&(e.boosts.def=Math.min(6,e.boosts.def+1))},e.checkEmbody=function(e,a){if(!(a.num<9))switch(e.ability){case"Embody Aspect (Cornerstone)":e.boosts.def=Math.min(6,e.boosts.def+1);break;case"Embody Aspect (Hearthflame)":e.boosts.atk=Math.min(6,e.boosts.atk+1);break;case"Embody Aspect (Teal)":e.boosts.spe=Math.min(6,e.boosts.spe+1);break;case"Embody Aspect (Wellspring)":e.boosts.spd=Math.min(6,e.boosts.spd+1)}},e.checkInfiltrator=function(e,a){e.hasAbility("Infiltrator")&&(a.isReflect=!1,a.isLightScreen=!1,a.isAuroraVeil=!1)},e.checkSeedBoost=function(e,a){if(e.item&&a.terrain&&e.item.includes("Seed")){var t=e.item.substring(0,e.item.indexOf(" "));a.hasTerrain(t)&&("Grassy"===t||"Electric"===t?e.boosts.def=e.hasAbility("Contrary")?Math.max(-6,e.boosts.def-1):Math.min(6,e.boosts.def+1):e.boosts.spd=e.hasAbility("Contrary")?Math.max(-6,e.boosts.spd-1):Math.min(6,e.boosts.spd+1))}},e.checkMultihitBoost=function(e,a,t,i,r,s,o){void 0===o&&(o=!1),i.named("Gyro Ball","Electro Ball")&&t.hasAbility("Gooey","Tangling Hair")?a.hasItem("White Herb")&&!o?(s.attackerItem=a.item,o=!0):(a.boosts.spe=Math.max(a.boosts.spe-1,-6),a.stats.spe=K(e,a,r,r.attackerSide),s.defenderAbility=t.ability):i.named("Power-Up Punch")&&(a.boosts.atk=Math.min(a.boosts.atk+1,6),a.stats.atk=z(a.rawStats.atk,a.boosts.atk,e)),t.hasAbility("Stamina")?a.hasAbility("Unaware")?s.attackerAbility=a.ability:(t.boosts.def=Math.min(t.boosts.def+1,6),t.stats.def=z(t.rawStats.def,t.boosts.def,e),s.defenderAbility=t.ability):t.hasAbility("Weak Armor")&&(a.hasAbility("Unaware")?s.attackerAbility=a.ability:t.hasItem("White Herb")&&!o?(s.defenderItem=t.item,o=!0):(t.boosts.def=Math.max(t.boosts.def-1,-6),t.stats.def=z(t.rawStats.def,t.boosts.def,e)),t.boosts.spe=Math.min(t.boosts.spe+2,6),t.stats.spe=K(e,t,r,r.defenderSide),s.defenderAbility=t.ability);var n=a.hasAbility("Simple")?2:1;if(i.dropsStats)if(a.hasAbility("Unaware"))s.attackerAbility=a.ability;else{var l="Special"===i.category?"spa":"atk",h=a.boosts[l];a.hasAbility("Contrary")?(h=Math.min(6,h+i.dropsStats),s.attackerAbility=a.ability):(h=Math.max(-6,h-i.dropsStats*n),n>1&&(s.attackerAbility=a.ability)),a.hasItem("White Herb")&&a.boosts[l]<0&&!o&&(h+=i.dropsStats*n,s.attackerItem=a.item,o=!0),a.boosts[l]=h,a.stats[l]=z(a.rawStats[l],t.boosts[l],e)}return o},e.chainMods=Z,e.getBaseDamage=function(e,a,t,i){return Math.floor(q(Math.floor(q(q(Math.floor(2*e/5+2)*a)*t)/i)/50+2))},e.getQPBoostedStat=j,e.isQPActive=_,e.getFinalDamage=function(e,a,t,i,r,s,o){var n=Math.floor(q(e*(85+a))/100);return 4096!==r&&(n=q(n*r)/4096),n=Math.floor(q(Q(n)*t)),i&&(n=Math.floor(n/2)),o&&(n=Q(q(1024*n)/4096)),Y(Q(Math.max(1,q(n*s)/4096)))},e.getShellSideArmCategory=function(e,a){return e.stats.atk/a.stats.def>e.stats.spa/a.stats.spd?"Physical":"Special"},e.getWeightFactor=function(e){return e.hasAbility("Heavy Metal")?2:e.hasAbility("Light Metal")||e.hasItem("Float Stone")?.5:1},e.countBoosts=function(e,a){var t,i,r=0,s=1===e.num?["atk","def","spa","spe"]:["atk","def","spa","spd","spe"];try{for(var o=S(s),n=o.next();!n.done;n=o.next()){var l=a[n.value];l&&l>0&&(r+=l)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}return r},e.getEVDescriptionText=function(e,a,t,i){var r=e.natures.get((0,o.toID)(i));return a.evs[t]+(r.plus===r.minus?"":r.plus===t?"+":r.minus===t?"-":"")+" "+f.Stats.displayStat(t)},e.handleFixedDamageMoves=function(e,a){return a.named("Seismic Toss","Night Shade")?e.level:a.named("Dragon Rage")?40:a.named("Sonic Boom")?20:0},e.pokeRound=Q,e.OF16=Y,e.OF32=q;var J=function(){function e(e,a,t,i,r,s,o){this.gen=e,this.attacker=a,this.defender=t,this.move=i,this.field=r,this.damage=s,this.rawDesc=o}return e.prototype.desc=function(){return this.fullDesc()},e.prototype.range=function(){var e=X(this.damage);if("number"==typeof e[0])return e;var a=e;return[a[0][0]+a[0][1],a[1][0]+a[1][1]]},e.prototype.fullDesc=function(e,a){return void 0===e&&(e="%"),void 0===a&&(a=!0),(0,ce.display)(this.gen,this.attacker,this.defender,this.move,this.field,this.damage,this.rawDesc,e,a)},e.prototype.moveDesc=function(e){return void 0===e&&(e="%"),(0,ce.displayMove)(this.gen,this.attacker,this.defender,this.move,this.damage,e)},e.prototype.recovery=function(e){return void 0===e&&(e="%"),(0,ce.getRecovery)(this.gen,this.attacker,this.defender,this.move,this.damage,e)},e.prototype.recoil=function(e){return void 0===e&&(e="%"),(0,ce.getRecoil)(this.gen,this.attacker,this.defender,this.move,this.damage,e)},e.prototype.kochance=function(e){return void 0===e&&(e=!0),(0,ce.getKOChance)(this.gen,this.attacker,this.defender,this.move,this.field,this.damage,e)},e}();function X(e){if("number"==typeof e)return[e,e];if(e.length>2){var a=e;return a[0]>a[a.length-1]?[Math.min.apply(Math,N([],P(a),!1)),Math.max.apply(Math,N([],P(a),!1))]:[a[0],a[a.length-1]]}if("number"==typeof e[0]&&"number"==typeof e[1])return[[e[0],e[1]],[e[0],e[1]]];var t=e;return t[0][0]>t[0][t[0].length-1]&&(t[0]=t[0].slice().sort()),t[1][0]>t[1][t[1].length-1]&&(t[1]=t[1].slice().sort()),[[t[0][0],t[1][0]],[t[0][t[0].length-1],t[1][t[1].length-1]]]}e.Result=J,e.damageRange=X;var $=e,ee=e;function ae(e,a,t,i,r,s){void 0===s&&(s="%");var o=P((0,$.damageRange)(r),2),n=o[0],l=o[1],h="number"==typeof n?[n]:n,c="number"==typeof l?[l]:l,d=[0,0],y="",u=3===e.num&&i.named("Doom Desire","Future Sight");if(a.hasItem("Shell Bell")&&!u)for(var m=Math.round(t.maxHP()/8),p=0;p<h.length;p++)d[0]+=Math.min(Math.round(h[p]*i.hits/8),m),d[1]+=Math.min(Math.round(c[p]*i.hits/8),m);if(i.named("G-Max Finale")&&(d[0]=d[1]=Math.round(a.maxHP()/6)),i.drain){var b=i.drain[0]/i.drain[1];for(m=Math.round(t.maxHP()*b),p=0;p<h.length;p++){var f=[h[p],c[p]];for(var g in d){var S=Math.round(f[g]*b);a.hasItem("Big Root")&&(S=Math.trunc(5324*S/4096)),d[g]+=Math.min(S*i.hits,m)}}}if(0===d[1])return{recovery:d,text:y};var v=he(s,d[0],a.maxHP()),A=he(s,d[1],a.maxHP());return{recovery:d,text:y="".concat(v," - ").concat(A).concat(s," recovered")}}function te(e,a,t,i,r,s){void 0===s&&(s="%");var o=P((0,$.damageRange)(r),2),n=o[0],l=o[1],h=("number"==typeof n?n:n[0]+n[1])*i.hits,c=("number"==typeof l?l:l[0]+l[1])*i.hits,d=[0,0],y="",u=n>t.curHP()||l>t.curHP();if(i.recoil){var m=i.recoil[0]/i.recoil[1]*100,p=void 0,b=void 0;u?(p=he(s,t.curHP()*m,a.maxHP(),100),b=he(s,t.curHP()*m,a.maxHP(),100)):(p=he(s,Math.min(h,t.curHP())*m,a.maxHP(),100),b=he(s,Math.min(c,t.curHP())*m,a.maxHP(),100)),a.hasAbility("Rock Head")||(d=[p,b],y="".concat(p," - ").concat(b).concat(s," recoil damage"))}else if(i.hasCrashDamage){var f=2===e.num?12.5:e.num>=3?50:1;p=void 0,b=void 0;switch(u&&2!==e.num?(p=he(s,t.curHP()*f,a.maxHP(),100),b=he(s,t.curHP()*f,a.maxHP(),100)):(p=he(s,Math.min(h,t.maxHP())*f,a.maxHP(),100),b=he(s,Math.min(c,t.maxHP())*f,a.maxHP(),100)),d=[p,b],e.num){case 1:d=he(s,1,a.maxHP()),y="1hp damage on miss";break;case 2:case 3:case 4:if(t.hasType("Ghost"))if(4===e.num){var g=Math.floor(.5*t.maxHP()/a.maxHP()*100);d="%"===s?g:Math.floor(g/100*48),y="".concat(g,"% crash damage")}else d=0,y="no crash damage on Ghost types";else y="".concat(p," - ").concat(b).concat(s," crash damage on miss");break;default:d="%"===s?24:50,y="50% crash damage"}}else i.struggleRecoil?(d="%"===s?12:25,y="25% struggle damage",4===e.num&&(y+=" (rounded down)")):i.mindBlownRecoil&&(d="%"===s?24:50,y="50% recoil damage");return{recoil:d,text:y}}function ie(e,a,t,i,r,s,n){if(void 0===n&&(n=!0),s=function(e){if("number"==typeof e)return[e];if(e.length>2)return e[0]>e[e.length-1]&&(e=e.slice().sort()),e;if("number"==typeof e[0]&&"number"==typeof e[1])return[e[0]+e[1]];for(var a=e,t=[],i=0;i<a[0].length;i++)for(var r=0;r<a[1].length;r++)t.push(a[0][i]+a[1][r]);return t.sort()}(s),isNaN(s[0]))return(0,o.error)(n,"damage[0] must be a number."),{chance:0,n:0,text:""};if(0===s[s.length-1])return(0,o.error)(n,"damage[damage.length - 1] === 0."),{chance:0,n:0,text:""};if((r.isMysteryRoom||a.hasAbility("Neutralizing Gas")||t.hasAbility("Neutralizing Gas"))&&(t.ability="",a.ability=""),r.hasWeather("Miasma")&&(t.hasAbility("Poison Heal")&&(t.ability=""),a.hasAbility("Poison Heal")&&(a.ability="")),void 0===i.timesUsed&&(i.timesUsed=1),void 0===i.timesUsedWithMetronome&&(i.timesUsedWithMetronome=1),s[0]>=t.maxHP()&&1===i.timesUsed&&1===i.timesUsedWithMetronome)return{chance:1,n:1,text:"guaranteed OHKO"};var l=function(e,a,t){var i=0,r=[];if(a.hasItem("Heavy-Duty Boots"))return{damage:i,texts:r};if(t.isSR&&!a.hasAbility("Magic Guard","Mountaineer")){var s=e.types.get("rock"),o=s.effectiveness[a.types[0]]*(a.types[1]?s.effectiveness[a.types[1]]:1);i+=Math.floor(o*a.maxHP()/8),r.push("Stealth Rock")}if(t.steelsurge&&!a.hasAbility("Magic Guard","Mountaineer")){var n=e.types.get("steel");o=n.effectiveness[a.types[0]]*(a.types[1]?n.effectiveness[a.types[1]]:1);i+=Math.floor(o*a.maxHP()/8),r.push("Steelsurge")}a.hasType("Flying")||a.hasAbility("Magic Guard","Levitate")||a.hasItem("Air Balloon")||(1===t.spikes?(i+=Math.floor(a.maxHP()/8),2===e.num?r.push("Spikes"):r.push("1 layer of Spikes")):2===t.spikes?(i+=Math.floor(a.maxHP()/6),r.push("2 layers of Spikes")):3===t.spikes&&(i+=Math.floor(a.maxHP()/4),r.push("3 layers of Spikes")));isNaN(i)&&(i=0);return{damage:i,texts:r}}(e,t,r.defenderSide),h=function(e,a,t,i,r){var s=0,o=[];r.hasWeather("Sun","Harsh Sunshine")?t.hasAbility("Dry Skin","Solar Power")&&(s-=Math.floor(t.maxHP()/8),o.push(t.ability+" damage")):r.hasWeather("Rain","Heavy Rain")?t.hasAbility("Dry Skin")?(s+=Math.floor(t.maxHP()/8),o.push("Dry Skin recovery")):t.hasAbility("Rain Dish")&&(s+=Math.floor(t.maxHP()/16),o.push("Rain Dish recovery")):r.hasWeather("Sand")?t.hasType("Rock","Ground","Steel")||t.hasAbility("Magic Guard","Overcoat","Sand Force","Sand Rush","Sand Veil")||t.hasItem("Safety Goggles")||(s-=Math.floor(t.maxHP()/(2===e.num?8:16)),o.push("sandstorm damage")):r.hasWeather("Hail","Snow")?t.hasAbility("Ice Body")?(s+=Math.floor(t.maxHP()/16),o.push("Ice Body recovery")):t.hasType("Ice")||t.hasAbility("Magic Guard","Overcoat","Snow Cloak")||t.hasItem("Safety Goggles")||!r.hasWeather("Hail")||(s-=Math.floor(t.maxHP()/16),o.push("hail damage")):r.hasWeather("Miasma")&&t.hasAbility("Chemical Bath")&&(s+=Math.floor(t.maxHP()/16),o.push("Chemical Bath recovery"));var n=i.named("Knock Off")&&!t.hasAbility("Sticky Hold");t.hasItem("Leftovers")&&!n?(s+=Math.floor(t.maxHP()/16),o.push("Leftovers recovery")):t.hasItem("Black Sludge")&&!n?t.hasType("Poison")?(s+=Math.floor(t.maxHP()/16),o.push("Black Sludge recovery")):t.hasAbility("Magic Guard","Klutz")||(s-=Math.floor(t.maxHP()/8),o.push("Black Sludge damage")):t.hasItem("Sticky Barb")&&(s-=Math.floor(t.maxHP()/8),o.push("Sticky Barb damage"));t.hasAbility("Dream Feast")&&(a.hasStatus("slp")||a.hasAbility("Comatose"))&&(s+=Math.floor(t.maxHP()/8),o.push("Dream Feast recovery"));t.hasAbility("Dumpster Diving")&&(s+=Math.floor(t.maxHP()/16),o.push("Dumpster Diving recovery"));r.defenderSide.isSeeded&&(t.hasAbility("Magic Guard")||(s-=Math.floor(t.maxHP()/(e.num>=2?8:16)),o.push("Leech Seed damage")));if(r.attackerSide.isSeeded&&!a.hasAbility("Magic Guard")){var l=Math.floor(a.maxHP()/(e.num>=2?8:16));t.hasItem("Big Root")&&(l=Math.trunc(5324*l/4096)),a.hasAbility("Liquid Ooze")?(s-=l,o.push("Liquid Ooze damage")):(s+=l,o.push("Leech Seed recovery"))}r.hasTerrain("Grassy")&&(0,ee.isGrounded)(t,r)&&(s+=Math.floor(t.maxHP()/16),o.push("Grassy Terrain recovery"));t.hasStatus("psn")?t.hasAbility("Poison Heal")?(s+=Math.floor(t.maxHP()/16),o.push("Poison Heal")):t.hasAbility("Magic Guard")||(s-=Math.floor(t.maxHP()/(1===e.num?16:8)),o.push("poison damage")):t.hasStatus("tox")?t.hasAbility("Poison Heal")?(s+=Math.floor(t.maxHP()/16),o.push("Poison Heal")):t.hasAbility("Magic Guard")||o.push("toxic damage"):t.hasStatus("brn")?t.hasAbility("Heatproof")?(s-=Math.floor(t.maxHP()/(e.num>6?32:16)),o.push("reduced burn damage")):t.hasAbility("Magic Guard")||(s-=Math.floor(t.maxHP()/(1===e.num||e.num>6?16:8)),o.push("burn damage")):(t.hasStatus("slp")||t.hasAbility("Comatose"))&&a.hasAbility("isBadDreams")&&!t.hasAbility("Magic Guard")&&(s-=Math.floor(t.maxHP()/8),o.push("Bad Dreams"));!t.hasAbility("Magic Guard")&&re.includes(i.name)&&(a.hasItem("Binding Band")?(s-=e.num>5?Math.floor(t.maxHP()/6):Math.floor(t.maxHP()/8),o.push("trapping damage")):(s-=e.num>5?Math.floor(t.maxHP()/8):Math.floor(t.maxHP()/16),o.push("trapping damage")));if(t.isSaltCure&&!t.hasAbility("Magic Guard")){var h=t.hasType("Water","Steel")||t.teraType&&["Water","Steel"].includes(t.teraType);s-=Math.floor(t.maxHP()/(h?4:8)),o.push("Salt Cure")}t.hasType("Fire")||t.hasAbility("Magic Guard")||!i.named("Fire Pledge (Grass Pledge Boosted)","Grass Pledge (Fire Pledge Boosted)")||(s-=Math.floor(t.maxHP()/8),o.push("Sea of Fire damage"));t.hasAbility("Magic Guard")||t.hasType("Grass")||!r.defenderSide.vinelash&&!i.named("G-Max Vine Lash")||(s-=Math.floor(t.maxHP()/6),o.push("Vine Lash damage"));t.hasAbility("Magic Guard")||t.hasType("Fire")||!r.defenderSide.wildfire&&!i.named("G-Max Wildfire")||(s-=Math.floor(t.maxHP()/6),o.push("Wildfire damage"));t.hasAbility("Magic Guard")||t.hasType("Water")||!r.defenderSide.cannonade&&!i.named("G-Max Cannonade")||(s-=Math.floor(t.maxHP()/6),o.push("Cannonade damage"));t.hasAbility("Magic Guard")||t.hasType("Rock")||!r.defenderSide.volcalith&&!i.named("G-Max Volcalith")||(s-=Math.floor(t.maxHP()/6),o.push("Volcalith damage"));return{damage:s,texts:o}}(e,a,t,i,r),c=t.hasStatus("tox")&&!t.hasAbility("Magic Guard","Poison Heal")?t.toxicCounter:0,d=i.hits>1?"approx. ":"",y=l.texts.length>0?" after "+ne(l.texts):"",u=l.texts.length>0||h.texts.length>0?" after "+ne(l.texts.concat(h.texts)):"",m=h.texts.length>0?" after "+ne(h.texts):"";if(!(1===i.timesUsed&&1===i.timesUsedWithMetronome||i.isZ))return 1===(p=se(s,t.maxHP()-l.damage,h.damage,i.hits||1,i.timesUsed||1,t.maxHP(),c))?{chance:p,n:i.timesUsed,text:"".concat(d||"guaranteed ","KO in ").concat(i.timesUsed," turns").concat(u)}:p>0?{chance:p,n:i.timesUsed,text:d+Math.round(1e3*p)/10+"% chance to ".concat(i.timesUsed,"HKO").concat(u)}:oe(s[0],h.damage,1,i.timesUsed,c,t.maxHP())>=t.curHP()-l.damage?{chance:1,n:i.timesUsed,text:"".concat(d||"guaranteed ","KO in ").concat(i.timesUsed," turns").concat(u)}:oe(s[s.length-1],h.damage,1,i.timesUsed,c,t.maxHP())>=t.curHP()-l.damage?{n:i.timesUsed,text:d+"possible KO in ".concat(i.timesUsed," turns").concat(u)}:{n:i.timesUsed,text:d+"not a KO"};var p=se(s,t.curHP()-l.damage,0,1,1,t.maxHP(),0),b=se(s,t.curHP()-l.damage,h.damage,1,1,t.maxHP(),c);if(1===p)return{chance:p,n:1,text:"guaranteed OHKO".concat(y)};if(p>0){if(1===b)return{chanceWithEot:b,n:1,text:d+Math.round(1e3*p)/10+"% chance to OHKO".concat(y," (guaranteed OHKO").concat(m,")")};if(b>p)return{chanceWithEot:b,n:1,text:d+Math.round(1e3*p)/10+"% chance to OHKO".concat(y," (")+d+Math.round(1e3*b)/10+"% to OHKO".concat(m,")")};if(p>0)return{chance:p,n:1,text:d+Math.round(1e3*p)/10+"% chance to OHKO".concat(u)}}else if(0==p){if(1===b)return{chanceWithEot:b,n:1,text:"guaranteed OHKO".concat(u)};if(b>0)return{chanceWithEot:b,n:1,text:d+Math.round(1e3*b)/10+"% chance to OHKO".concat(u)}}256===s.length&&(d="approx. ");for(var f=2;f<=4;f++){var g=se(s,t.curHP()-l.damage,h.damage,f,1,t.maxHP(),c);if(1===g)return{chance:g,n:f,text:"".concat(d||"guaranteed ").concat(f,"HKO").concat(u)};if(g>0)return{chance:g,n:f,text:d+Math.round(1e3*g)/10+"% chance to ".concat(f,"HKO").concat(u)}}for(f=5;f<=9;f++){if(oe(s[0],h.damage,f,1,c,t.maxHP())>=t.curHP()-l.damage)return{chance:1,n:f,text:"".concat(d||"guaranteed ").concat(f,"HKO").concat(u)};if(oe(s[s.length-1],h.damage,f,1,c,t.maxHP())>=t.curHP()-l.damage)return{n:f,text:d+"possible ".concat(f,"HKO").concat(u)}}return{chance:0,n:0,text:""}}e.display=function(e,a,t,i,r,s,o,n,l){void 0===n&&(n="%"),void 0===l&&(l=!0);var h=P((0,$.damageRange)(s),2),c=h[0],d=h[1],y="number"==typeof c?c:c[0]+c[1],u="number"==typeof d?d:d[0]+d[1],m=he(n,y,t.maxHP()),p=he(n,u,t.maxHP()),b=function(e,a,t){var i=P(function(e,a){if(e.level!==a.level)return[100===e.level?"":"Lvl ".concat(e.level),100===a.level?"":"Lvl ".concat(a.level)];var t=[100,50,5].includes(e.level),i=t?"":"Lvl ".concat(e.level);return[i,i]}(a,t),2),r=i[0],s=i[1],o="";e.attackBoost&&(e.attackBoost>0&&(o+="+"),o+=e.attackBoost+" ");o=le(o,r),o=le(o,e.attackEVs),o=le(o,e.attackerItem),o=le(o,e.attackerAbility),o=le(o,e.rivalry),e.isBurned&&(o+="burned ");e.alliesFainted&&(o+=Math.min(5,e.alliesFainted)+" ".concat(1===e.alliesFainted?"ally":"allies"," fainted "));e.attackerTera&&(o+="Tera ".concat(e.attackerTera," "));e.isBeadsOfRuin&&(o+="Beads of Ruin ");e.isSwordOfRuin&&(o+="Sword of Ruin ");o+=e.attackerName+" ",e.isHelpingHand&&(o+="Helping Hand ");e.isFlowerGiftAttacker&&(o+="with an ally's Flower Gift ");e.isBattery&&(o+="Battery boosted ");e.isPowerSpot&&(o+="Power Spot boosted ");e.isSwitching&&(o+="switching boosted ");o+=e.moveName+" ",e.moveBP&&e.moveType?o+="("+e.moveBP+" BP "+e.moveType+") ":e.moveBP?o+="("+e.moveBP+" BP) ":e.moveType&&(o+="("+e.moveType+") ");e.hits&&(o+="("+e.hits+" hits) ");o=le(o,e.moveTurns),o+="vs. ",e.defenseBoost&&(e.defenseBoost>0&&(o+="+"),o+=e.defenseBoost+" ");o=le(o,s),o=le(o,e.HPEVs),e.defenseEVs&&(o+="/ "+e.defenseEVs+" ");o=le(o,e.defenderItem),o=le(o,e.defenderAbility),e.isTabletsOfRuin&&(o+="Tablets of Ruin ");e.isVesselOfRuin&&(o+="Vessel of Ruin ");e.isProtected&&(o+="protected ");e.isDefenderDynamaxed&&(o+="Dynamax ");e.defenderTera&&(o+="Tera ".concat(e.defenderTera," "));o+=e.defenderName,e.weather&&e.terrain||(e.weather?o+=" in "+e.weather:e.terrain&&(o+=" in "+e.terrain+" Terrain"));e.isReflect?o+=" through Reflect":e.isLightScreen&&(o+=" through Light Screen");e.isFlowerGiftDefender&&(o+=" with an ally's Flower Gift");e.isFriendGuard&&(o+=" with an ally's Friend Guard");e.isAuroraVeil&&(o+=" with an ally's Aurora Veil");e.isCritical&&(o+=" on a critical hit");e.isWonderRoom&&(o+=" in Wonder Room");return o}(o,a,t),f="".concat(y,"-").concat(u," (").concat(m," - ").concat(p).concat(n,")");if("Status"===i.category&&!i.named("Nature Power"))return"".concat(b,": ").concat(f);var g=ie(e,a,t,i,r,s,l).text;return g?"".concat(b,": ").concat(f," -- ").concat(g):"".concat(b,": ").concat(f)},e.displayMove=function(e,a,t,i,r,s){void 0===s&&(s="%");var o=P((0,$.damageRange)(r),2),n=o[0],l=o[1],h="number"==typeof n?n:n[0]+n[1],c="number"==typeof l?l:l[0]+l[1],d=he(s,h,t.maxHP()),y=he(s,c,t.maxHP()),u=ae(e,a,t,i,r,s).text,m=te(e,a,t,i,r,s).text;return"".concat(d," - ").concat(y).concat(s).concat(u&&" (".concat(u,")")).concat(m&&" (".concat(m,")"))},e.getRecovery=ae,e.getRecoil=te,e.getKOChance=ie;var re=["Bind","Clamp","Fire Spin","Infestation","Magma Storm","Sand Tomb","Thunder Cage","Whirlpool","Wrap","G-Max Sandblast","G-Max Centiferno"];function se(e,a,t,i,r,s,o){var n=0;o>0&&(n=Math.floor(o*s/16),o++);var l=e.length;if(1===i){t-n>0&&(t=0,n=0);for(var h=0;h<l;h++){if(e[l-1]-t+n<a)return 0;if(e[h]-t+n>=a)return(l-h)/l}}var c=0,d=0;for(h=0;h<l;h++){var y=void 0;if(1===(y=0===h||e[h]!==e[h-1]?se(e,a-e[h]+t-n,t,i-1,r,s,o):d)){c+=l-h;break}c+=y,d=y}return c/l}function oe(e,a,t,i,r,s){var o=0;if(r>0)for(var n=0;n<t-1;n++)o+=Math.floor((r+n)*s/16);return t>1&&1===i?e*t-a*(t-1)+o:e-a*(t-1)+o}function ne(e){if(0===e.length)return"";if(1===e.length)return e[0];if(2===e.length)return e[0]+" and "+e[1];for(var a="",t=0;t<e.length-1;t++)a+=e[t]+", ";return a+"and "+e[e.length-1]}function le(e,a){return a?"".concat(e).concat(a," "):e}function he(e,a,t,i){return void 0===i&&(i=1),"%"===e?Math.floor(a*(1e3/i)/t)/10:Math.floor(a*(48/i)/t)}var ce=e,de=e;function ye(e,a,t,i,r,s,o){var n,l,h=a.stats.spe>t.stats.spe?"first":"last";switch(i.name){case"Payback":l=i.bp*("last"===h?2:1),o.moveBP=l;break;case"Bolt Beak":case"Fishious Rend":l=i.bp*("last"!==h?2:1),o.moveBP=l;break;case"Pursuit":var c="out"===r.defenderSide.isSwitching;l=i.bp*(c?2:1),c&&(o.isSwitching="out"),o.moveBP=l;break;case"Electro Ball":var d=Math.floor(a.stats.spe/t.stats.spe);l=d>=4?150:d>=3?120:d>=2?80:d>=1?60:40,0===t.stats.spe&&(l=40),o.moveBP=l;break;case"Gyro Ball":l=Math.min(150,Math.floor(25*t.stats.spe/a.stats.spe)+1),0===a.stats.spe&&(l=1),o.moveBP=l;break;case"Punishment":l=Math.min(200,60+20*(0,ee.countBoosts)(e,t.boosts)),o.moveBP=l;break;case"Low Kick":case"Grass Knot":var y=t.weightkg*(0,ee.getWeightFactor)(t);l=y>=200?120:y>=100?100:y>=50?80:y>=25?60:y>=10?40:20,o.moveBP=l;break;case"Hex":case"Infernal Parade":case"Shadow Sorcery":l=i.bp*(t.status||t.hasAbility("Comatose")?2:1),o.moveBP=l;break;case"Barb Barrage":l=i.bp*(t.hasStatus("psn","tox")?2:1),o.moveBP=l;break;case"Heavy Slam":case"Heat Crash":var u=a.weightkg*(0,ee.getWeightFactor)(a)/(t.weightkg*(0,ee.getWeightFactor)(t));l=u>=5?120:u>=4?100:u>=3?80:u>=2?60:40,o.moveBP=l;break;case"Stored Power":case"Power Trip":case"Snuggle Bug":l=20+20*(0,ee.countBoosts)(e,a.boosts),o.moveBP=l;break;case"Shadow Punish":l=55+30*(0,ee.countBoosts)(e,t.boosts),o.moveBP=l;break;case"Acrobatics":l=i.bp*(a.hasItem("Flying Gem")||!a.item||(0,ee.isQPActive)(a,r)?2:1),o.moveBP=l;break;case"Assurance":l=i.bp*(t.hasAbility("Parental Bond (Child)")?2:1);break;case"Wake-Up Slap":l=i.bp*(t.hasStatus("slp")||t.hasAbility("Comatose")?2:1),o.moveBP=l;break;case"Smelling Salts":l=i.bp*(t.hasStatus("par")?2:1),o.moveBP=l;break;case"Weather Ball":l=i.bp*(r.weather&&!r.hasWeather("Strong Winds")?2:1),r.hasWeather("Sun","Harsh Sunshine","Rain","Heavy Rain","Miasma")&&a.hasItem("Utility Umbrella")&&(l=i.bp),o.moveBP=l;break;case"Terrain Pulse":l=i.bp*((0,ee.isGrounded)(a,r)&&r.terrain?2:1),o.moveBP=l;break;case"Rising Voltage":l=i.bp*((0,ee.isGrounded)(t,r)&&r.hasTerrain("Electric")?2:1),o.moveBP=l;break;case"Psyblade":l=i.bp*(r.hasTerrain("Electric")?1.5:1),r.hasTerrain("Electric")&&(o.moveBP=l,o.terrain=r.terrain);break;case"Fling":l=(0,de.getFlingPower)(a.item),o.moveBP=l,o.attackerItem=a.item;break;case"Dragon Energy":case"Eruption":case"Icefall":case"Water Spout":l=Math.max(1,Math.floor(150*a.curHP()/a.maxHP())),o.moveBP=l;break;case"Flail":case"Reversal":case"Shadow Vengeance":var m=Math.floor(48*a.curHP()/a.maxHP());l=m<=1?200:m<=4?150:m<=9?100:m<=16?80:m<=32?40:20,o.moveBP=l;break;case"Natural Gift":if(null===(n=a.item)||void 0===n?void 0:n.includes("Berry"))l=(0,de.getNaturalGift)(e,a.item).p,o.attackerItem=a.item,o.moveBP=i.bp;else l=i.bp;break;case"Nature Power":switch(i.category="Special",i.secondaries=!0,r.terrain){case"Electric":l=90,o.moveName="Thunderbolt";break;case"Grassy":l=90,o.moveName="Energy Ball";break;case"Misty":l=95,o.moveName="Moonblast";break;case"Psychic":l=90,o.moveName="Psychic";break;default:l=80,o.moveName="Tri Attack"}break;case"Water Shuriken":l=a.named("Greninja-Ash")&&a.hasAbility("Battle Bond")?20:15,o.moveBP=l;break;case"Triple Axel":case"Triple Kick":l=2===i.hits?30:3===i.hits?40:20,o.moveBP=l;break;case"Crush Grip":case"Wring Out":case"Hard Press":l=100*Math.floor(4096*t.curHP()/t.maxHP()),l=Math.floor(Math.floor((120*l+2048-1)/4096)/100)||1,o.moveBP=l;break;case"Synchronoise":l=i.bp*(t.hasType(a.types[0])||a.types[1]&&t.hasType(a.types[1])?2:1),o.moveBP=l;break;case"Tera Blast":l="Stellar"===a.teraType?100:80,o.moveBP=l;break;default:l=i.bp}if(0===l)return 0;i.named("Breakneck Blitz","Bloom Doom","Inferno Overdrive","Hydro Vortex","Gigavolt Havoc","Subzero Slammer","Supersonic Skystrike","Savage Spin-Out","Acid Downpour","Tectonic Rage","Continental Crush","All-Out Pummeling","Shattered Psyche","Never-Ending Nightmare","Devastating Drake","Black Hole Eclipse","Corkscrew Crash","Twinkle Tackle")&&(o.moveBP=i.bp);var p=ue(e,a,t,i,r,o,l,s,h);return l=(0,ee.OF16)(Math.max(1,(0,ee.pokeRound)(l*(0,ee.chainMods)(p,41,2097152)/4096))),a.teraType&&i.type===a.teraType&&a.hasType(a.teraType)&&1===i.hits&&i.priority<=0&&i.bp>0&&!i.named("Dragon Energy","Eruption","Water Spout")&&l<60&&e.num>=9&&(l=60,o.moveBP=60),l}function ue(e,a,t,i,r,s,n,l,h){var c=[];a.hasAbility("Cunning Blade")&&"Physical"===i.category&&i.flags.blade&&(i.category="Special",i.flags.contact=0);var d=!t.item||(0,ee.isQPActive)(t,r)||t.named("Dialga-Origin")&&t.hasItem("Adamant Crystal")||t.named("Palkia-Origin")&&t.hasItem("Lustrous Globe")||t.name.includes("Giratina-Origin")&&t.item.includes("Griseous")||t.name.includes("Arceus")&&t.item.includes("Plate")||t.name.includes("Genesect")&&t.item.includes("Drive")||t.named("Groudon","Groudon-Primal")&&t.hasItem("Red Orb")||t.named("Kyogre","Kyogre-Primal")&&t.hasItem("Blue Orb")||t.name.includes("Silvally")&&t.item.includes("Memory")||t.item.includes(" Z")||t.named("Zacian")&&t.hasItem("Rusted Sword")||t.named("Zamazenta")&&t.hasItem("Rusted Shield")||t.name.includes("Ogerpon-Cornerstone")&&t.hasItem("Cornerstone Mask")||t.name.includes("Ogerpon-Hearthflame")&&t.hasItem("Hearthflame Mask")||t.name.includes("Ogerpon-Wellspring")&&t.hasItem("Wellspring Mask")||t.named("Venomicon-Epilogue")&&t.hasItem("Vile Vial")||t.named("Kiwuit")&&t.hasAbility("Ambrosia")&&t.item&&e.items.get((0,o.toID)(t.item)).isBerry||t.named("Meganium")&&t.hasItem("Fragrent Herb")||t.named("Pyukumuku")&&t.hasItem("Strange Mucus")||t.name.includes("Cherrim")&&t.hasItem("Cerise Orb")||t.name.includes("Phione")&&t.hasItem("Teal Orb");if(!d&&t.item){var y=e.items.get((0,o.toID)(t.item));d=!!y.megaEvolves&&t.name.includes(y.megaEvolves)}if(i.named("Facade")&&a.hasStatus("brn","par","psn","tox")||i.named("Brine")&&t.curHP()<=t.maxHP()/2||i.named("Venoshock")&&t.hasStatus("psn","tox")||i.named("Lash Out")&&(0,ee.countBoosts)(e,a.boosts)<0)c.push(8192),s.moveBP=2*n;else if(i.named("Expanding Force")&&(0,ee.isGrounded)(a,r)&&r.hasTerrain("Psychic"))i.target="allAdjacentFoes",c.push(6144),s.moveBP=1.5*n;else if(i.named("Tera Starstorm")&&"Terapagos-Stellar"===a.name)i.target="allAdjacentFoes",i.type="Stellar";else if(i.named("Knock Off")&&!d||i.named("Misty Explosion")&&(0,ee.isGrounded)(a,r)&&r.hasTerrain("Misty")||i.named("Grav Apple")&&r.isGravity)c.push(6144),s.moveBP=1.5*n;else if(i.named("Solar Beam","Solar Blade")&&r.hasWeather("Rain","Heavy Rain","Sand","Hail","Snow"))c.push(2048),s.moveBP=n/2,s.weather=r.weather;else if(i.named("Collision Course","Electro Drift")){var u=a.hasAbility("Scrappy")||a.hasAbility("Mind's Eye")||r.defenderSide.isForesight,m=t.hasItem("Ring Target")&&!t.hasAbility("Klutz"),p=a.hasAbility("Bone Master")&&!!i.flags.bone,b=t.teraType?[t.teraType]:t.types;(0,ee.getMoveEffectiveness)(e,i,b[0],u,r.isGravity,m,p)*(b[1]?(0,ee.getMoveEffectiveness)(e,i,b[1],u,r.isGravity,m,p):1)>=2&&(c.push(5461),s.moveBP=n*(5461/4096))}r.attackerSide.isHelpingHand&&(c.push(6144),s.isHelpingHand=!0);var f=e.num>7?5325:6144;(0,ee.isGrounded)(a,r)&&(r.hasTerrain("Electric")&&i.hasType("Electric")||r.hasTerrain("Grassy")&&i.hasType("Grass")||r.hasTerrain("Psychic")&&i.hasType("Psychic"))&&(c.push(f),s.terrain=r.terrain),(0,ee.isGrounded)(t,r)&&(r.hasTerrain("Misty")&&i.hasType("Dragon")||r.hasTerrain("Grassy")&&i.named("Bulldoze","Earthquake"))&&(c.push(2048),s.terrain=r.terrain),(a.hasAbility("Technician")&&n<=60||a.hasAbility("Flare Boost")&&a.hasStatus("brn")&&"Special"===i.category||a.hasAbility("Toxic Boost")&&a.hasStatus("psn","tox")&&"Physical"===i.category||a.hasAbility("Mega Launcher")&&i.flags.pulse||a.hasAbility("Strong Jaw")&&i.flags.bite||a.hasAbility("Steely Spirit")&&i.hasType("Steel")||a.hasAbility("Sharpness")&&i.flags.slicing||a.hasAbility("Escape Artist")&&i.named("Flip Turn","U-turn","Volt Switch","Shadow Pivot","Propulsion Shot"))&&(c.push(6144),s.attackerAbility=a.ability);var g="".concat(i.type," Aura"),S=a.hasAbility(g),v=t.hasAbility(g),A=a.hasAbility("Aura Break")||t.hasAbility("Aura Break"),k=r.isAuraBreak,P=r.isFairyAura&&"Fairy"===i.type,M=r.isDarkAura&&"Dark"===i.type;if((S||v||P||M)&&(k||A?(c.push(3072),s.attackerAbility=a.ability,s.defenderAbility=t.ability):(c.push(5448),S&&(s.attackerAbility=a.ability),v&&(s.defenderAbility=t.ability))),(a.hasAbility("Sheer Force")&&(i.secondaries||i.named("Jet Punch","Order Up"))&&!i.isMax||a.hasAbility("Sand Force")&&r.hasWeather("Sand")&&i.hasType("Rock","Ground","Steel")||a.hasAbility("Analytic")&&("first"!==h||"out"===r.defenderSide.isSwitching)||a.hasAbility("Tough Claws")&&i.flags.contact||a.hasAbility("Punk Rock")&&i.flags.sound)&&(c.push(5325),s.attackerAbility=a.ability),r.attackerSide.isBattery&&"Special"===i.category&&(c.push(5325),s.isBattery=!0),r.attackerSide.isPowerSpot&&(c.push(5325),s.isPowerSpot=!0),a.hasAbility("Rivalry")&&![a.gender,t.gender].includes("N")&&(a.gender===t.gender?(c.push(5120),s.rivalry="buffed"):(c.push(3072),s.rivalry="nerfed"),s.attackerAbility=a.ability),!i.isMax&&l&&c.push(4915),(a.hasAbility("Reckless")&&(i.recoil||i.hasCrashDamage)||a.hasAbility("Iron Fist")&&i.flags.punch||a.hasAbility("Cunning Blade")&&i.flags.blade)&&(c.push(4915),s.attackerAbility=a.ability),a.hasItem("Punching Glove")&&i.flags.punch&&(c.push(4506),s.attackerItem=a.item),e.num<=8&&t.hasAbility("Heatproof")&&i.hasType("Fire")?(c.push(2048),s.defenderAbility=t.ability):t.hasAbility("Dry Skin")&&i.hasType("Fire")&&(c.push(5120),s.defenderAbility=t.ability),a.hasAbility("Supreme Overlord")&&a.alliesFainted){c.push([4096,4506,4915,5325,5734,6144][Math.min(5,a.alliesFainted)]),s.attackerAbility=a.ability,s.alliesFainted=a.alliesFainted}return a.hasAbility("High Caliber")&&i.flags.bullet&&(c.push(5325),s.defenderAbility=t.ability),a.hasItem("".concat(i.type," Gem"))?(c.push(5325),s.attackerItem=a.item):(a.hasItem("Adamant Crystal")&&a.named("Dialga-Origin")||a.hasItem("Adamant Orb")&&a.named("Dialga"))&&i.hasType("Steel","Dragon")||(a.hasItem("Lustrous Orb")&&a.named("Palkia")||a.hasItem("Lustrous Globe")&&a.named("Palkia-Origin"))&&i.hasType("Water","Dragon")||(a.hasItem("Griseous Orb")||a.hasItem("Griseous Core"))&&(a.named("Giratina-Origin")||a.named("Giratina"))&&i.hasType("Ghost","Dragon")||a.hasItem("Vile Vial")&&a.named("Venomicon-Epilogue")&&i.hasType("Poison","Flying")||a.hasItem("Soul Dew")&&a.named("Latios","Latias","Latios-Mega","Latias-Mega")&&i.hasType("Psychic","Dragon")||a.item&&i.hasType((0,de.getItemBoostType)(a.item))||a.name.includes("Ogerpon-Cornerstone")&&a.hasItem("Cornerstone Mask")||a.name.includes("Ogerpon-Hearthflame")&&a.hasItem("Hearthflame Mask")||a.name.includes("Ogerpon-Wellspring")&&a.hasItem("Wellspring Mask")?(c.push(4915),s.attackerItem=a.item):(a.hasItem("Muscle Band")&&"Physical"===i.category||a.hasItem("Wise Glasses")&&"Special"===i.category)&&(c.push(4505),s.attackerItem=a.item),c}function me(e,a,t,i,r,s,o){var n;void 0===o&&(o=!1);var l=i.named("Foul Play")?t:a;(i.named("Photon Geyser","Light That Burns The Sky")||i.named("Tera Blast")&&l.teraType)&&(i.category=l.stats.atk>l.stats.spa?"Physical":"Special");var h=i.named("Shell Side Arm")&&"Physical"===(0,ee.getShellSideArmCategory)(a,t)?"atk":i.named("Body Press")?"def":"Special"===i.category?"spa":"atk";s.attackEVs=i.named("Foul Play")?(0,ee.getEVDescriptionText)(e,t,h,t.nature):(0,ee.getEVDescriptionText)(e,a,h,a.nature),0===l.boosts[h]||o&&l.boosts[h]<0?n=l.rawStats[h]:t.hasAbility("Unaware")?(n=l.rawStats[h],s.defenderAbility=t.ability):(n=l.stats[h],s.attackBoost=l.boosts[h]),a.hasAbility("Hustle")&&"Physical"===i.category&&(n=(0,ee.pokeRound)(3*n/2),s.attackerAbility=a.ability);var c=pe(e,a,t,i,r,s);return n=(0,ee.OF16)(Math.max(1,(0,ee.pokeRound)(n*(0,ee.chainMods)(c,410,131072)/4096)))}function pe(e,a,t,i,r,s){var o=[];a.hasAbility("Slow Start")&&a.abilityOn&&("Physical"===i.category||"Special"===i.category&&i.isZ)||a.hasAbility("Defeatist")&&a.curHP()<=a.maxHP()/2?(o.push(2048),s.attackerAbility=a.ability):a.hasAbility("Solar Power")&&r.hasWeather("Sun","Harsh Sunshine")&&"Special"===i.category||a.named("Cherrim")&&a.hasAbility("Flower Gift")&&r.hasWeather("Sun","Harsh Sunshine")&&"Physical"===i.category||a.hasAbility("Ice Breaker")&&r.hasWeather("Hail","Snow")&&"Physical"===i.category?(o.push(6144),s.attackerAbility=a.ability,s.weather=r.weather):a.hasAbility("Galaxian")&&r.isGravity&&"Special"===i.category||a.hasAbility("Gorilla Tactics")&&"Physical"===i.category&&!a.isDynamaxed?(o.push(6144),s.attackerAbility=a.ability):r.attackerSide.isFlowerGift&&r.hasWeather("Sun","Harsh Sunshine")&&"Physical"===i.category?(o.push(6144),s.weather=r.weather,s.isFlowerGiftAttacker=!0):a.hasAbility("Guts")&&a.status&&"Physical"===i.category||a.curHP()<=a.maxHP()/4&&a.hasAbility("Adrenalize")||a.curHP()<=a.maxHP()/3&&(a.hasAbility("Overgrow")&&i.hasType("Grass")||a.hasAbility("Blaze")&&i.hasType("Fire")||a.hasAbility("Torrent")&&i.hasType("Water")||a.hasAbility("Swarm")&&i.hasType("Bug"))||"Special"===i.category&&a.abilityOn&&a.hasAbility("Plus","Minus")?(o.push(6144),s.attackerAbility=a.ability):a.hasAbility("Flash Fire")&&a.abilityOn&&i.hasType("Fire")?(o.push(6144),s.attackerAbility="Flash Fire"):a.hasAbility("Steelworker")&&i.hasType("Steel")||a.hasAbility("Dragon's Maw")&&i.hasType("Dragon")||a.hasAbility("Rocky Payload")&&i.hasType("Rock")||a.hasAbility("Corona")&&i.hasType("Fire")?(o.push(6144),s.attackerAbility=a.ability):a.hasAbility("Transistor")&&i.hasType("Electric")?(o.push(e.num>=9?5325:6144),s.attackerAbility=a.ability):(a.hasAbility("Stakeout")&&a.abilityOn||a.hasAbility("Water Bubble")&&i.hasType("Water")||a.hasAbility("Huge Power","Pure Power")&&"Physical"===i.category||a.hasAbility("Mystic Power")&&"Special"===i.category)&&(o.push(8192),s.attackerAbility=a.ability),(t.hasAbility("Thick Fat")&&i.hasType("Fire","Ice")||t.hasAbility("Primal Warmth")&&i.hasType("Fire","Water")||t.hasAbility("Water Bubble")&&i.hasType("Fire")||t.hasAbility("Purifying Salt")&&i.hasType("Ghost"))&&(o.push(2048),s.defenderAbility=t.ability),e.num>=9&&t.hasAbility("Heatproof")&&i.hasType("Fire")&&(o.push(2048),s.defenderAbility=t.ability);var n=(t.hasAbility("Tablets of Ruin")||r.isTabletsOfRuin)&&!a.hasAbility("Tablets of Ruin"),l=(t.hasAbility("Vessel of Ruin")||r.isVesselOfRuin)&&!a.hasAbility("Vessel of Ruin");return(n&&"Physical"===i.category||l&&"Special"===i.category)&&(t.hasAbility("Tablets of Ruin")||t.hasAbility("Vessel of Ruin")?s.defenderAbility=t.ability:s["Special"===i.category?"isVesselOfRuin":"isTabletsOfRuin"]=!0,o.push(3072)),(0,ee.isQPActive)(a,r)&&("Physical"===i.category&&"atk"===(0,ee.getQPBoostedStat)(a)||"Special"===i.category&&"spa"===(0,ee.getQPBoostedStat)(a))&&(o.push(5325),s.attackerAbility=a.ability),(a.hasAbility("Hadron Engine")&&"Special"===i.category&&r.hasTerrain("Electric")&&(0,ee.isGrounded)(a,r)||a.hasAbility("Orichalcum Pulse")&&"Physical"===i.category&&r.hasWeather("Sun","Harsh Sunshine")&&!a.hasItem("Utility Umbrella"))&&(o.push(5461),s.attackerAbility=a.ability),a.hasItem("Thick Club")&&a.named("Cubone","Marowak","Marowak-Alola","Marowak-Alola-Totem")&&"Physical"===i.category||a.hasItem("Deep Sea Tooth")&&a.named("Clamperl")&&"Special"===i.category||a.hasItem("Light Ball")&&a.name.includes("Pikachu")&&!i.isZ?(o.push(8192),s.attackerItem=a.item):i.isZ||i.isMax||!(a.hasItem("Choice Band")&&"Physical"===i.category||a.hasItem("Choice Specs")&&"Special"===i.category)||(o.push(6144),s.attackerItem=a.item),o}function be(e,a,t,i,r,s,o){var n;void 0===o&&(o=!1);var l="spd"!==i.overrideDefensiveStat&&("def"===i.overrideDefensiveStat||"Physical"===i.category||i.named("Shell Side Arm")&&"Physical"===(0,ee.getShellSideArmCategory)(a,t)),h=l?"def":"spd";s.defenseEVs=(0,ee.getEVDescriptionText)(e,t,h,t.nature),0===t.boosts[h]||o&&t.boosts[h]>0||i.ignoreDefensive?n=t.rawStats[h]:a.hasAbility("Unaware")?(n=t.rawStats[h],s.attackerAbility=a.ability):(n=t.stats[h],s.defenseBoost=t.boosts[h]),r.hasWeather("Sand")&&t.hasType("Rock")&&!l&&(n=(0,ee.pokeRound)(3*n/2),s.weather=r.weather),r.hasWeather("Snow")&&t.hasType("Ice")&&l&&(n=(0,ee.pokeRound)(3*n/2),s.weather=r.weather);var c=fe(e,a,t,i,r,s,o,l);return(0,ee.OF16)(Math.max(1,(0,ee.pokeRound)(n*(0,ee.chainMods)(c,410,131072)/4096)))}function fe(e,a,t,i,r,s,n,l){var h;void 0===n&&(n=!1),void 0===l&&(l=!1);var c=[];t.hasAbility("Marvel Scale")&&t.status&&l?(c.push(6144),s.defenderAbility=t.ability):t.named("Cherrim")&&t.hasAbility("Flower Gift")&&r.hasWeather("Sun","Harsh Sunshine")&&!l?(c.push(6144),s.defenderAbility=t.ability,s.weather=r.weather):r.defenderSide.isFlowerGift&&r.hasWeather("Sun","Harsh Sunshine")&&!l?(c.push(6144),s.weather=r.weather,s.isFlowerGiftDefender=!0):t.hasAbility("Grass Pelt")&&r.hasTerrain("Grassy")&&l||t.hasAbility("Misty Cover")&&r.hasTerrain("Misty")&&!l?(c.push(6144),s.defenderAbility=t.ability):t.hasAbility("Fur Coat")&&l&&(c.push(8192),s.defenderAbility=t.ability);var d=(a.hasAbility("Sword of Ruin")||r.isSwordOfRuin)&&!t.hasAbility("Sword of Ruin"),y=(a.hasAbility("Beads of Ruin")||r.isBeadsOfRuin)&&!t.hasAbility("Beads of Ruin");return(d&&l||y&&!l)&&(a.hasAbility("Sword of Ruin")||a.hasAbility("Beads of Ruin")?s.attackerAbility=a.ability:s[l?"isSwordOfRuin":"isBeadsOfRuin"]=!0,c.push(3072)),(0,ee.isQPActive)(t,r)&&(l&&"def"===(0,ee.getQPBoostedStat)(t)||!l&&"spd"===(0,ee.getQPBoostedStat)(t))&&(s.defenderAbility=t.ability,c.push(5324)),t.hasItem("Eviolite")&&("Dipplin"===t.name||(null===(h=e.species.get((0,o.toID)(t.name)))||void 0===h?void 0:h.nfe))||!l&&t.hasItem("Assault Vest")?(c.push(6144),s.defenderItem=t.item):(t.hasItem("Metal Powder")&&t.named("Ditto")&&l||t.hasItem("Deep Sea Scale")&&t.named("Clamperl")&&!l)&&(c.push(8192),s.defenderItem=t.item),c}function ge(e,a,t,i,r,s,o,n,l,h){void 0===h&&(h=!1);var c=(0,ee.getBaseDamage)(a.level,i,r,s);return"Singles"!==n.gameType&&["allAdjacent","allAdjacentFoes"].includes(o.target)&&(c=(0,ee.pokeRound)((0,ee.OF32)(3072*c)/4096)),a.hasAbility("Parental Bond (Child)")&&(c=(0,ee.pokeRound)((0,ee.OF32)(1024*c)/4096)),n.hasWeather("Sun")&&o.named("Hydro Steam")&&!a.hasItem("Utility Umbrella")?(c=(0,ee.pokeRound)((0,ee.OF32)(6144*c)/4096),l.weather=n.weather):t.hasItem("Utility Umbrella")||(n.hasWeather("Sun","Harsh Sunshine")&&o.hasType("Fire")||n.hasWeather("Rain","Heavy Rain")&&o.hasType("Water")||n.hasWeather("Miasma")&&o.hasType("Poison")?(c=(0,ee.pokeRound)((0,ee.OF32)(6144*c)/4096),l.weather=n.weather):(n.hasWeather("Sun")&&o.hasType("Water")||n.hasWeather("Rain")&&o.hasType("Fire"))&&(c=(0,ee.pokeRound)((0,ee.OF32)(2048*c)/4096),l.weather=n.weather)),h&&(c=Math.floor((0,ee.OF32)(1.5*c)),l.isCritical=h),c}function Se(e,a,t,i,r,s,o,n,l){void 0===o&&(o=!1),void 0===l&&(l=0);var h=[];if(!r.defenderSide.isReflect||"Physical"!==i.category||o||r.defenderSide.isAuroraVeil?!r.defenderSide.isLightScreen||"Special"!==i.category||o||r.defenderSide.isAuroraVeil||(h.push("Singles"!==r.gameType?2732:2048),s.isLightScreen=!0):(h.push("Singles"!==r.gameType?2732:2048),s.isReflect=!0),r.defenderSide.isAuroraVeil&&!o&&(h.push("Singles"!==r.gameType?2732:2048),s.isAuroraVeil=!0),a.hasAbility("Neuroforce")&&n>1?(h.push(5120),s.attackerAbility=a.ability):a.hasAbility("Sniper")&&o?(h.push(6144),s.attackerAbility=a.ability):a.hasAbility("Tinted Lens")&&n<1&&(h.push(8192),s.attackerAbility=a.ability),t.isDynamaxed&&i.named("Dynamax Cannon","Behemoth Blade","Behemoth Bash")&&h.push(8192),!t.hasAbility("Multiscale","Shadow Shield")||t.curHP()!==t.maxHP()||0!==l||(r.defenderSide.isSR||r.defenderSide.spikes&&!t.hasType("Flying"))&&!t.hasItem("Heavy-Duty Boots")||a.hasAbility("Parental Bond (Child)")||(h.push(2048),s.defenderAbility=t.ability),(t.hasAbility("Fluffy")&&i.flags.contact&&!a.hasAbility("Long Reach")||t.hasAbility("Punk Rock")&&i.flags.sound||t.hasAbility("Ice Scales")&&"Special"===i.category)&&(h.push(2048),s.defenderAbility=t.ability),t.hasAbility("Solid Rock","Filter","Prism Armor")&&n>1&&(h.push(3072),s.defenderAbility=t.ability),t.hasAbility("Bagwormicade")&&n>1&&(h.push(2048),s.defenderAbility=t.ability),t.hasAbility("Enfeebling Venom")&&a.hasStatus("psn","tox")&&(h.push(2048),s.defenderAbility=t.ability),r.defenderSide.isFriendGuard&&(h.push(3072),s.isFriendGuard=!0),t.hasAbility("Fluffy")&&i.hasType("Fire")&&(h.push(8192),s.defenderAbility=t.ability),a.hasItem("Expert Belt")&&n>1&&!i.isZ)h.push(4915),s.attackerItem=a.item;else if(a.hasItem("Life Orb"))h.push(5324),s.attackerItem=a.item;else if(a.hasItem("Metronome")&&i.timesUsedWithMetronome>=1){var c=Math.floor(i.timesUsedWithMetronome);c<=4?h.push(4096+819*c):h.push(8192),s.attackerItem=a.item}return i.hasType((0,de.getBerryResistType)(t.item))&&(n>1||i.hasType("Normal"))&&0===l&&!a.hasAbility("Unnerve","As One (Glastrier)","As One (Spectrier)")&&(t.hasAbility("Ripen")?h.push(1024):h.push(2048),s.defenderItem=t.item),h}function ve(e,a,t,i,r,s,o,n,l){void 0===l&&(l=!1);var h=(0,ee.getBaseDamage)(a.level,t,i,r);return"Singles"!==o.gameType&&["allAdjacent","allAdjacentFoes"].includes(s.target)&&(h=(0,ee.pokeRound)((0,ee.OF32)(3072*h)/4096)),a.hasAbility("Parental Bond (Child)")&&(h=(0,ee.pokeRound)((0,ee.OF32)(2048*h)/4096)),o.hasWeather("Sun","Harsh Sunshine")&&s.hasType("Fire")||o.hasWeather("Rain","Heavy Rain")&&s.hasType("Water")||o.hasWeather("Miasma")&&s.hasType("Poison")?(h=(0,ee.pokeRound)((0,ee.OF32)(6144*h)/4096),n.weather=o.weather):(o.hasWeather("Sun")&&s.hasType("Water")||o.hasWeather("Rain")&&s.hasType("Fire"))&&(h=(0,ee.pokeRound)((0,ee.OF32)(2048*h)/4096),n.weather=o.weather),l&&(h=Math.floor((0,ee.OF32)(h*(e.num>5?1.5:2))),n.isCritical=l),h}function Ae(e,a,t,i,r,s,o,n,l){void 0===o&&(o=!1),void 0===l&&(l=0);var h=[];if(r.defenderSide.isReflect&&"Physical"===i.category&&!o?(h.push("Singles"!==r.gameType?e.num>5?2732:2703:2048),s.isReflect=!0):r.defenderSide.isLightScreen&&"Special"===i.category&&!o&&(h.push("Singles"!==r.gameType?e.num>5?2732:2703:2048),s.isLightScreen=!0),!t.hasAbility("Multiscale")||t.curHP()!==t.maxHP()||0!==l||r.defenderSide.isSR||r.defenderSide.spikes&&!t.hasType("Flying")||a.hasAbility("Parental Bond (Child)")||(h.push(2048),s.defenderAbility=t.ability),a.hasAbility("Tinted Lens")&&n<1&&(h.push(8192),s.attackerAbility=a.ability),r.defenderSide.isFriendGuard&&(h.push(3072),s.isFriendGuard=!0),a.hasAbility("Sniper")&&o&&(h.push(6144),s.attackerAbility=a.ability),t.hasAbility("Solid Rock","Filter")&&n>1&&(h.push(3072),s.defenderAbility=t.ability),t.hasAbility("Bagwormicade")&&n>1&&(h.push(2048),s.defenderAbility=t.ability),t.hasAbility("Enfeebling Venom")&&a.hasStatus("psn","tox")&&(h.push(2048),s.defenderAbility=t.ability),a.hasItem("Metronome")&&i.timesUsedWithMetronome>=1){var c=Math.floor(i.timesUsedWithMetronome);c<=4?h.push(4096+819*c):h.push(8192),s.attackerItem=a.item}return a.hasItem("Expert Belt")&&n>1&&!i.isZ?(h.push(4915),s.attackerItem=a.item):a.hasItem("Life Orb")&&(h.push(5324),s.attackerItem=a.item),i.hasType((0,de.getBerryResistType)(t.item))&&(n>1||i.hasType("Normal"))&&!a.hasAbility("Unnerve")&&(h.push(2048),s.defenderItem=t.item),h}e.calculateSMSSSV=function e(a,t,i,r,s){(0,ee.checkAirLock)(t,s),(0,ee.checkAirLock)(i,s),(0,ee.checkTeraformZero)(t,s),(0,ee.checkTeraformZero)(i,s),(0,ee.checkForecast)(t,s.weather),(0,ee.checkForecast)(i,s.weather),(0,ee.checkItem)(t,s.isMagicRoom),(0,ee.checkItem)(i,s.isMagicRoom),(0,ee.checkWonderRoom)(t,s.isWonderRoom),(0,ee.checkWonderRoom)(i,s.isWonderRoom),(0,ee.checkSeedBoost)(t,s),(0,ee.checkSeedBoost)(i,s),(0,ee.checkDauntlessShield)(t,a),(0,ee.checkDauntlessShield)(i,a),(0,ee.checkEmbody)(t,a),(0,ee.checkEmbody)(i,a),(0,ee.checkSearchEngine)(i,t),(0,ee.checkSearchEngine)(t,i),(0,ee.checkInflate)(t),(0,ee.checkInflate)(i),(0,ee.computeFinalStats)(a,t,i,s,"def","spd","spe"),(0,ee.checkIntimidate)(a,t,i),(0,ee.checkIntimidate)(a,i,t),(0,ee.checkDownload)(t,i,s.isWonderRoom),(0,ee.checkDownload)(i,t,s.isWonderRoom),(0,ee.checkIntrepidSword)(t,a),(0,ee.checkIntrepidSword)(i,a),(0,ee.computeFinalStats)(a,t,i,s,"atk","spa"),(0,ee.checkInfiltrator)(t,s.defenderSide),(0,ee.checkInfiltrator)(i,s.attackerSide);var n={attackerName:t.name,attackerTera:t.teraType,moveName:r.name,defenderName:i.name,defenderTera:i.teraType,isDefenderDynamaxed:i.isDynamaxed,isWonderRoom:s.isWonderRoom},l=new $.Result(a,t,i,r,s,0,n);if("Status"===r.category&&!r.named("Nature Power"))return l;var h=r.breaksProtect||r.isZ||t.isDynamaxed||t.hasAbility("Unseen Fist")&&r.flags.contact;if(s.defenderSide.isProtected&&!h)return n.isProtected=!0,l;(s.isMysteryRoom||t.hasAbility("Neutralizing Gas")||i.hasAbility("Neutralizing Gas"))&&(i.ability="",t.ability="");var c=i.hasAbility("Full Metal Body","Neutralizing Gas","Prism Armor","Shadow Shield"),d=t.hasAbility("Mold Breaker","Teravolt","Turboblaze"),y=r.named("G-Max Drum Solo","G-Max Fire Ball","G-Max Hydrosnipe","Light That Burns the Sky","Menacing Moonraze Maelstrom","Moongeist Beam","Photon Geyser","Searing Sunraze Smash","Sunsteel Strike");c||i.hasAbility("Poison Heal")||!d&&!y||(d&&(n.attackerAbility=t.ability),i.hasItem("Ability Shield")?n.defenderItem=i.item:i.ability="");var u=!i.hasAbility("Battle Armor","Shell Armor")&&(r.isCrit||t.hasAbility("Merciless")&&i.hasStatus("psn","tox"))&&1===r.timesUsed,m=r.type;if(r.named("Weather Ball")){var p=t.hasItem("Utility Umbrella");m=s.hasWeather("Sun","Harsh Sunshine")&&!p?"Fire":s.hasWeather("Rain","Heavy Rain")&&!p?"Water":s.hasWeather("Sand")?"Rock":s.hasWeather("Hail","Snow")?"Ice":"Normal",n.weather=s.weather,n.moveType=m}else if(r.named("Judgment")&&t.item&&t.item.includes("Plate"))m=(0,de.getItemBoostType)(t.item);else if(r.named("Primal Burst")&&t.item&&t.item.includes("Orb"))m=(0,de.getOrbType)(t.item);else if(r.named("Techno Blast")&&t.item&&t.item.includes("Drive"))m=(0,de.getTechnoBlast)(t.item);else if(r.named("Multi-Attack")&&t.item&&t.item.includes("Memory"))m=(0,de.getMultiAttack)(t.item);else if(r.named("Natural Gift")&&t.item&&t.item.includes("Berry")){m=(0,de.getNaturalGift)(a,t.item).t,n.moveType=m,n.attackerItem=t.item}else r.named("Nature Power")||r.named("Terrain Pulse")&&(0,ee.isGrounded)(t,s)?(m=s.hasTerrain("Electric")?"Electric":s.hasTerrain("Grassy")?"Grass":s.hasTerrain("Misty")?"Fairy":s.hasTerrain("Psychic")?"Psychic":"Normal",n.terrain=s.terrain,n.moveType=m):r.named("Revelation Dance")?m=t.teraType?t.teraType:t.types[0]:r.named("Aura Wheel")?t.named("Morpeko")?m="Electric":t.named("Morpeko-Hangry")&&(m="Dark"):r.named("Seasonal Spirit")?t.named("Sawsbuck-Spring")?m="Fairy":t.named("Sawsbuck-Summer")?m="Fire":t.named("Sawsbuck-Autumn")?m="Ground":t.named("Sawsbuck-Winter")&&(m="Ice"):r.named("Raging Bull")?t.named("Tauros-Paldea-Combat")?m="Fighting":t.named("Tauros-Paldea-Blaze")?m="Fire":t.named("Tauros-Paldea-Aqua")&&(m="Water"):r.named("Ivy Cudgel")&&(t.name.includes("Ogerpon-Cornerstone")?m="Rock":t.name.includes("Ogerpon-Hearthflame")?m="Fire":t.name.includes("Ogerpon-Wellspring")&&(m="Water"));var b=!1,f=!1,g=!1,S=!1,v=!1,A=!1,k=!1,P=r.named("Revelation Dance","Judgment","Nature Power","Techno Blast","Multi Attack","Natural Gift","Weather Ball","Terrain Pulse","Struggle")||r.named("Tera Blast")&&t.teraType;if(!r.isZ&&!P){var M=r.hasType("Normal");(f=t.hasAbility("Aerilate")&&M)?m="Flying":(v=t.hasAbility("Galvanize")&&M)?m="Electric":(A=t.hasAbility("Liquid Voice")&&!!r.flags.sound)?m="Water":(g=t.hasAbility("Pixilate")&&M)?m="Fairy":(S=t.hasAbility("Refrigerate")&&M)?m="Ice":(k=t.hasAbility("Normalize"))&&(m="Normal"),v||g||S||f||k?(n.attackerAbility=t.ability,b=!0):A&&(n.attackerAbility=t.ability)}r.named("Tera Blast")&&t.teraType&&(m=t.teraType),r.type=m,t.hasAbility("Cunning Blade")&&r.flags.blade&&(r.category="Special",r.flags.contact=0),(t.hasAbility("Triage")&&r.drain||t.hasAbility("Gale Wings")&&r.hasType("Flying")&&t.curHP()===t.maxHP()||t.hasAbility("Melody Allegretto")&&r.flags.sound)&&(r.priority=1,n.attackerAbility=t.ability);var T=t.hasAbility("Scrappy")||t.hasAbility("Mind's Eye")||s.defenderSide.isForesight,w=s.defenderSide.isMiracleEye||t.hasAbility("Psyche Control"),B=i.hasItem("Ring Target")&&!i.hasAbility("Klutz"),F=t.hasAbility("Bone Master")&&!!r.flags.bone,x=(0,ee.getMoveEffectiveness)(a,r,i.types[0],T,w,s.isGravity,B,F)*(i.types[1]?(0,ee.getMoveEffectiveness)(a,r,i.types[1],T,w,s.isGravity,B,F):1);if(i.teraType&&"Stellar"!==i.teraType&&(x=(0,ee.getMoveEffectiveness)(a,r,i.teraType,T,w,s.isGravity,B,F)),0===x&&r.hasType("Ground")&&i.hasItem("Iron Ball")&&!i.hasAbility("Klutz")&&(x=1),0===x&&r.named("Thousand Arrows")&&(x=1),0===x)return l;if(r.named("Sky Drop")&&(i.hasType("Flying")||i.weightkg>=200||s.isGravity)||r.named("Dream Eater")&&!i.hasStatus("slp")&&!i.hasAbility("Comatose")||r.named("Steel Roller")&&!s.terrain||r.named("Poltergeist")&&(!i.item||(0,ee.isQPActive)(i,s)))return l;if(s.hasWeather("Harsh Sunshine")&&r.hasType("Water")||s.hasWeather("Heavy Rain")&&r.hasType("Fire"))return n.weather=s.weather,l;if((s.hasWeather("Strong Winds")||i.hasAbility("Cloud Guard"))&&i.hasType("Flying")&&a.types.get((0,o.toID)(r.type)).effectiveness.Flying>1&&(x/=2,s.hasWeather("Strong Winds")?n.weather=s.weather:n.defenderAbility=i.ability),"Stellar"===r.type&&(x=i.teraType?2:1),!i.hasAbility("Tera Shell")||i.curHP()!==i.maxHP()||(s.defenderSide.isSR||s.defenderSide.spikes&&!i.hasType("Flying"))&&!i.hasItem("Heavy-Duty Boots")||(x=.5,n.defenderAbility=i.ability),i.hasAbility("Wonder Guard")&&x<=1||r.hasType("Grass")&&i.hasAbility("Sap Sipper")||r.hasType("Fire")&&i.hasAbility("Flash Fire","Flame Absorb","Well-Baked Body")||r.hasType("Water")&&i.hasAbility("Dry Skin","Storm Drain","Water Absorb")||r.hasType("Bug")&&i.hasAbility("Bugcatcher")||r.hasType("Ground")&&i.hasAbility("Clay Construction")||r.hasType("Electric")&&i.hasAbility("Lightning Rod","Motor Drive","Volt Absorb")||r.hasType("Ground")&&!s.isGravity&&!r.named("Thousand Arrows")&&!i.hasItem("Iron Ball")&&(!i.hasAbility("Bone Master")||!r.flags.bone)&&(i.hasAbility("Levitate")||i.hasAbility("Inflate")&&i.abilityOn)||r.flags.bullet&&i.hasAbility("Bulletproof")||r.flags.blade&&i.hasAbility("Bladeproof")||r.flags.sound&&!r.named("Clangorous Soul")&&i.hasAbility("Soundproof")||r.priority>0&&i.hasAbility("Queenly Majesty","Dazzling","Armor Tail")||r.hasType("Ground")&&i.hasAbility("Earth Eater")||r.flags.wind&&i.hasAbility("Wind Rider")||r.hasType("Ghost","Dark")&&i.hasAbility("Baku Shield")||r.hasType("Poison")&&i.hasAbility("Acid Absorb")||r.hasType("Dark")&&i.hasAbility("Karma")||i.named("Kiwuit")&&i.hasAbility("Ambrosia")&&i.item&&a.items.get((0,o.toID)(i.item)).isBerry&&(0,de.getNaturalGift)(a,i.item).t===r.type)return n.defenderAbility=i.ability,l;if(r.hasType("Ground")&&!r.named("Thousand Arrows")&&!s.isGravity&&i.hasItem("Air Balloon"))return n.defenderItem=i.item,l;if(r.priority>0&&s.hasTerrain("Psychic")&&(0,ee.isGrounded)(i,s))return n.terrain=s.terrain,l;var R=r.named("Heat Crash","Heavy Slam","Low Kick","Grass Knot");if(i.isDynamaxed&&R)return l;n.HPEVs="".concat(i.evs.hp," HP");var G=(0,ee.handleFixedDamageMoves)(t,r);if(G)return t.hasAbility("Parental Bond")?(l.damage=[G,G],n.attackerAbility=t.ability):l.damage=G,l;if(r.named("Final Gambit"))return l.damage=t.curHP(),l;if(r.named("Guardian of Alola")){var I=Math.floor(3*i.curHP()/4);return s.defenderSide.isProtected&&t.item&&t.item.includes(" Z")&&(I=Math.ceil(I/4-.5)),l.damage=I,l}if(r.named("Nature's Madness")){var D=s.defenderSide.isProtected?0:Math.floor(i.curHP()/2);return l.damage=D,l}if(r.named("Spectral Thief","Cat Burglary")){var H=void 0;for(H in i.boosts)i.boosts[H]>0&&(t.boosts[H]+=t.hasAbility("Contrary")?-i.boosts[H]:i.boosts[H],t.boosts[H]>6&&(t.boosts[H]=6),t.boosts[H]<-6&&(t.boosts[H]=-6),t.stats[H]=(0,ee.getModifiedStat)(t.rawStats[H],t.boosts[H]),i.boosts[H]=0,i.stats[H]=i.rawStats[H])}r.hits>1&&(n.hits=r.hits),t.stats.spe,i.stats.spe;var W=ye(a,t,i,r,s,b,n);if(0===W)return l;var C=me(a,t,i,r,s,n,u),O=r.named("Foul Play")?i:t;(r.named("Photon Geyser","Light That Burns The Sky")||r.named("Tera Blast")&&O.teraType)&&(r.category=O.stats.atk>O.stats.spa?"Physical":"Special");var E=r.named("Shell Side Arm")&&"Physical"===(0,ee.getShellSideArmCategory)(t,i)?"atk":r.named("Body Press")?"def":"Special"===r.category?"spa":"atk";r.named("Combardment")&&i.stats.def>i.stats.spd&&(r.overrideDefensiveStat="spd");var V=be(a,t,i,r,s,n,u),L="spd"!==r.overrideDefensiveStat&&("def"===r.overrideDefensiveStat||"Physical"===r.category||r.named("Shell Side Arm")&&"Physical"===(0,ee.getShellSideArmCategory)(t,i)),N=L?"def":"spd",U=ge(a,t,i,W,C,V,r,s,n,u);i.hasItem("Electric Seed","Misty Seed","Grassy Seed","Psychic Seed")&&s.hasTerrain(i.item.substring(0,i.item.indexOf(" ")))&&de.SEED_BOOSTED_STAT[i.item]===N&&(n.defenderItem=i.item);var z=4096;t.hasOriginalType(r.type)?z+=2048:t.hasAbility("Protean","Libero")&&!t.teraType&&(z+=2048,n.attackerAbility=t.ability);var K=t.teraType;K===r.type&&"Stellar"!==K&&(z+=2048,n.attackerTera=K),t.hasAbility("Adaptability")&&t.hasType(r.type)&&(z+=K&&t.hasOriginalType(K)?1024:2048,n.attackerAbility=t.ability),"Stellar"===t.teraType&&(r.isStellarFirstUse||t.named("Terapagos-Stellar"))&&(t.hasOriginalType(r.type)?z+=2048:z=4915);var Z=t.hasStatus("brn")&&"Physical"===r.category&&!t.hasAbility("Guts")&&!r.named("Facade","Shadow Rage");n.isBurned=Z;var j=Se(a,t,i,r,s,n,u,x),_=!1;s.defenderSide.isProtected&&(t.isDynamaxed||r.isZ&&t.item&&t.item.includes(" Z"))&&(_=!0,n.isProtected=!0);var Q,Y=(0,ee.chainMods)(j,41,131072),q="Singles"!==s.gameType&&["allAdjacent","allAdjacentFoes"].includes(r.target);if(t.hasAbility("Parental Bond")&&1===r.hits&&!q){var J=t.clone();J.ability="Parental Bond (Child)",(0,ee.checkMultihitBoost)(a,J,i,r,s,n),Q=e(a,J,i,r,s).damage,n.attackerAbility=t.ability}for(var X=[],ae=0;ae<16;ae++)X[ae]=(0,ee.getFinalDamage)(U,ae,x,Z,z,Y,_);if(r.dropsStats&&r.timesUsed>1){var te=t.hasAbility("Simple")?2:1;n.moveTurns="over ".concat(r.timesUsed," turns");for(var ie=t.hasItem("White Herb"),re=!1,se=0,oe=function(e){var a=(0,ee.getModifiedStat)(C,se),i=0;X=X.map((function(r){if(e){var s=(0,ee.getBaseDamage)(t.level,W,a,V),o=(0,ee.getFinalDamage)(s,i,x,Z,z,Y,_);return i++,r+o}return r})),t.hasAbility("Contrary")?(se=Math.min(6,se+r.dropsStats),n.attackerAbility=t.ability):(se=Math.max(-6,se-r.dropsStats*te),t.hasAbility("Simple")&&(n.attackerAbility=t.ability)),ie&&t.boosts[E]<0&&!re&&(se+=r.dropsStats*te,re=!0,n.attackerItem=t.item)},ne=0;ne<r.timesUsed;ne++)oe(ne)}if(r.hits>1){var le=0,he=function(e){var o=(0,ee.getModifiedStat)(V,le),l=0;X=X.map((function(h){if(e){var c=Se(a,t,i,r,s,n,u,x,e),d=(0,ee.chainMods)(c,41,131072),y=ge(a,t,i,W,C,o,r,s,n,u),m=(0,ee.getFinalDamage)(y,l,x,Z,z,d,_);return l++,h+m}return h})),L&&"Stamina"===i.ability?(le=Math.min(6,le+1),n.defenderAbility="Stamina"):L&&"Weak Armor"===i.ability&&(le=Math.max(-6,le-1),n.defenderAbility="Weak Armor")};for(ne=0;ne<r.hits;ne++)he(ne)}return n.attackBoost=r.named("Foul Play")?i.boosts[E]:t.boosts[E],l.damage=Q?[X,Q]:X,l},e.calculateBasePowerSMSSSV=ye,e.calculateBPModsSMSSSV=ue,e.calculateAttackSMSSSV=me,e.calculateAtModsSMSSSV=pe,e.calculateDefenseSMSSSV=be,e.calculateDfModsSMSSSV=fe,e.calculateFinalModsSMSSSV=Se,e.calculateBWXY=function e(a,t,i,r,s){var n;(0,ee.checkAirLock)(t,s),(0,ee.checkAirLock)(i,s),(0,ee.checkForecast)(t,s.weather),(0,ee.checkForecast)(i,s.weather),(0,ee.checkItem)(t,s.isMagicRoom),(0,ee.checkItem)(i,s.isMagicRoom),(0,ee.checkWonderRoom)(t,s.isWonderRoom),(0,ee.checkWonderRoom)(i,s.isWonderRoom),(0,ee.checkSeedBoost)(t,s),(0,ee.checkSeedBoost)(i,s),(0,ee.checkSearchEngine)(i,t),(0,ee.checkSearchEngine)(t,i),(0,ee.checkInflate)(t),(0,ee.checkInflate)(i),(0,ee.computeFinalStats)(a,t,i,s,"def","spd","spe"),(0,ee.checkIntimidate)(a,t,i),(0,ee.checkIntimidate)(a,i,t),(0,ee.checkDownload)(t,i,s.isWonderRoom),(0,ee.checkDownload)(i,t,s.isWonderRoom),(0,ee.computeFinalStats)(a,t,i,s,"atk","spa"),(0,ee.checkInfiltrator)(t,s.defenderSide),(0,ee.checkInfiltrator)(i,s.attackerSide);var l={attackerName:t.name,moveName:r.name,defenderName:i.name,isWonderRoom:s.isWonderRoom},h=new $.Result(a,t,i,r,s,0,l);if("Status"===r.category&&!r.named("Nature Power"))return h;if(t.hasAbility("Cunning Blade")&&r.flags.blade&&(r.category="Special"),s.defenderSide.isProtected&&!r.breaksProtect)return l.isProtected=!0,h;s.isMysteryRoom&&(i.ability="",t.ability=""),t.hasAbility("Mold Breaker","Teravolt","Turboblaze")&&(i.ability="",l.attackerAbility=t.ability);var c=r.isCrit&&!i.hasAbility("Battle Armor","Shell Armor")&&1===r.timesUsed;if(r.named("Weather Ball"))r.type=s.hasWeather("Sun","Harsh Sunshine")?"Fire":s.hasWeather("Rain","Heavy Rain")?"Water":s.hasWeather("Sand")?"Rock":s.hasWeather("Hail")?"Ice":"Normal",l.weather=s.weather,l.moveType=r.type;else if(r.named("Judgment")&&t.item&&t.item.includes("Plate"))r.type=(0,de.getItemBoostType)(t.item);else if(r.named("Primal Burst")&&t.item&&t.item.includes("Orb"))r.type=(0,de.getOrbType)(t.item);else if(r.named("Techno Blast")&&t.item&&t.item.includes("Drive"))r.type=(0,de.getTechnoBlast)(t.item);else if(r.named("Natural Gift")&&t.item&&t.item.includes("Berry")){var d=(0,de.getNaturalGift)(a,t.item);r.type=d.t,r.bp=d.p,l.attackerItem=t.item,l.moveBP=r.bp,l.moveType=r.type}else r.named("Nature Power")?5===a.num?r.type="Ground":r.type=s.hasTerrain("Electric")?"Electric":s.hasTerrain("Grassy")?"Grass":s.hasTerrain("Misty")?"Fairy":"Normal":r.named("Seasonal Spirit")&&(t.named("Sawsbuck-Spring")?r.type="Fairy":t.named("Sawsbuck-Summer")?r.type="Fire":t.named("Sawsbuck-Autumn")?r.type="Ground":t.named("Sawsbuck-Winter")&&(r.type="Ice"));t.hasAbility("Cunning Blade")&&"Physical"===r.category&&r.flags.blade&&(r.category="Special",r.flags.contact=0);var y=!1,u=!1,m=!1,p=!1,b=r.named("Judgment","Nature Power","Techo Blast","Natural Gift","Weather Ball","Struggle");if(!r.isZ&&!b){var f=r.hasType("Normal");(y=t.hasAbility("Aerilate")&&f)?r.type="Flying":(u=t.hasAbility("Pixilate")&&f)?r.type="Fairy":(m=t.hasAbility("Refrigerate")&&f)?r.type="Ice":(p=t.hasAbility("Normalize"))&&(r.type="Normal"),(u||m||y||p)&&(l.attackerAbility=t.ability)}(t.hasAbility("Gale Wings")&&r.hasType("Flying")||t.hasAbility("Melody Allegretto")&&r.flags.sound)&&(r.priority=1,l.attackerAbility=t.ability);var g=t.hasAbility("Scrappy")||s.defenderSide.isForesight,S=s.defenderSide.isMiracleEye||t.hasAbility("Psyche Control"),v=t.hasAbility("Bone Master")&&!!r.flags.bone,A=(0,ee.getMoveEffectiveness)(a,r,i.types[0],g,S,s.isGravity,!1,v),k=i.types[1]?(0,ee.getMoveEffectiveness)(a,r,i.types[1],g,S,s.isGravity,!1,v):1,P=A*k,M=!i.item||i.named("Giratina-Origin")&&i.hasItem("Griseous Orb")||i.name.includes("Arceus")&&i.item.includes("Plate")||i.name.includes("Genesect")&&i.item.includes("Drive")||i.named("Groudon","Groudon-Primal")&&i.hasItem("Red Orb")||i.named("Kyogre","Kyogre-Primal")&&i.hasItem("Blue Orb")||i.named("Kiwuit")&&i.hasAbility("Ambrosia")&&i.item&&a.items.get((0,o.toID)(i.item)).isBerry||i.named("Meganium")&&i.hasItem("Fragrent Herb")||i.named("Pyukumuku")&&i.hasItem("Strange Mucus")||i.name.includes("Cherrim")&&i.hasItem("Cerise Orb")||i.name.includes("Phione")&&i.hasItem("Teal Orb");if(!M&&i.item){var T=a.items.get((0,o.toID)(i.item));M=!(!T.megaEvolves||!i.name.includes(T.megaEvolves))}if(0===P&&r.named("Thousand Arrows"))P=1;else if(0===P&&r.hasType("Ground")&&i.hasItem("Iron Ball")&&!i.hasAbility("Klutz"))P=1;else if(0===P&&i.hasItem("Ring Target")){var w=a.types.get((0,o.toID)(r.type)).effectiveness;0===w[i.types[0]]?P=k:i.types[1]&&0===w[i.types[1]]&&(P=A)}if(0===P)return h;if(r.named("Sky Drop")&&(i.hasType("Flying")||i.weightkg>=200||s.isGravity)||r.named("Synchronoise")&&!i.hasType(t.types[0])&&(!t.types[1]||!i.hasType(t.types[1]))||r.named("Dream Eater")&&!i.hasStatus("slp"))return h;if(s.hasWeather("Harsh Sunshine")&&r.hasType("Water")||s.hasWeather("Heavy Rain")&&r.hasType("Fire"))return l.weather=s.weather,h;if((s.hasWeather("Strong Winds")||i.hasAbility("Cloud Guard"))&&i.hasType("Flying")&&a.types.get((0,o.toID)(r.type)).effectiveness.Flying>1&&(P/=2,s.hasWeather("Strong Winds")?l.weather=s.weather:l.defenderAbility=i.ability),i.hasAbility("Wonder Guard")&&P<=1||r.hasType("Grass")&&i.hasAbility("Sap Sipper")||r.hasType("Fire")&&i.hasAbility("Flash Fire","Flame Absorb")||r.hasType("Water")&&i.hasAbility("Dry Skin","Storm Drain","Water Absorb")||r.hasType("Bug")&&i.hasAbility("Bugcatcher")||r.hasType("Ground")&&i.hasAbility("Clay Construction")||r.hasType("Electric")&&i.hasAbility("Lightning Rod","Motor Drive","Volt Absorb")||r.hasType("Ground")&&!s.isGravity&&!r.named("Thousand Arrows")&&(!i.hasAbility("Bone Master")||!r.flags.bone)&&!i.hasItem("Iron Ball")&&(i.hasAbility("Levitate")||i.hasAbility("Inflate")&&i.abilityOn)||r.flags.bullet&&i.hasAbility("Bulletproof")||r.flags.sound&&i.hasAbility("Soundproof")||r.flags.blade&&i.hasAbility("Bladeproof")||r.hasType("Ghost","Dark")&&i.hasAbility("Baku Shield")||r.hasType("Poison")&&i.hasAbility("Acid Absorb")||r.hasType("Dark")&&i.hasAbility("Karma")||i.named("Kiwuit")&&i.hasAbility("Ambrosia")&&i.item&&a.items.get((0,o.toID)(i.item)).isBerry&&(0,de.getNaturalGift)(a,i.item).t===r.type)return l.defenderAbility=i.ability,h;if(r.hasType("Ground")&&!r.named("Thousand Arrows")&&!s.isGravity&&i.hasItem("Air Balloon"))return l.defenderItem=i.item,h;if(r.priority>0&&s.hasTerrain("Psychic")&&(0,ee.isGrounded)(i,s))return l.terrain=s.terrain,h;l.HPEVs="".concat(i.evs.hp," HP");var B=(0,ee.handleFixedDamageMoves)(t,r);if(B)return t.hasAbility("Parental Bond")?(h.damage=[B,B],l.attackerAbility=t.ability):h.damage=B,h;if(r.named("Final Gambit"))return h.damage=t.curHP(),h;if(r.named("Cat Burglary")){var F=void 0;for(F in i.boosts)i.boosts[F]>0&&(t.boosts[F]+=t.hasAbility("Contrary")?-i.boosts[F]:i.boosts[F],t.boosts[F]>6&&(t.boosts[F]=6),t.boosts[F]<-6&&(t.boosts[F]=-6),t.stats[F]=(0,ee.getModifiedStat)(t.rawStats[F],t.boosts[F]),i.boosts[F]=0,i.stats[F]=i.rawStats[F])}r.hits>1&&(l.hits=r.hits);var x,R=t.stats.spe>i.stats.spe?"first":"last";switch(r.name){case"Payback":x=r.bp*("last"===R?2:1),l.moveBP=x;break;case"Pursuit":var G="out"===s.defenderSide.isSwitching;x=r.bp*(G?2:1),G&&(l.isSwitching="out"),l.moveBP=x;break;case"Electro Ball":0===i.stats.spe&&(i.stats.spe=1);var I=Math.floor(t.stats.spe/i.stats.spe);x=I>=4?150:I>=3?120:I>=2?80:I>=1?60:40,l.moveBP=x;break;case"Gyro Ball":0===t.stats.spe&&(t.stats.spe=1),x=Math.min(150,Math.floor(25*i.stats.spe/t.stats.spe)+1),l.moveBP=x;break;case"Punishment":x=Math.min(200,60+20*(0,ee.countBoosts)(a,i.boosts)),l.moveBP=x;break;case"Low Kick":case"Grass Knot":var D=i.weightkg*(0,ee.getWeightFactor)(i);x=D>=200?120:D>=100?100:D>=50?80:D>=25?60:D>=10?40:20,l.moveBP=x;break;case"Hex":case"Infernal Parade":case"Shadow Sorcery":x=r.bp*(i.status?2:1),l.moveBP=x;break;case"Heavy Slam":case"Heat Crash":var H=t.weightkg*(0,ee.getWeightFactor)(t)/(i.weightkg*(0,ee.getWeightFactor)(i));x=H>=5?120:H>=4?100:H>=3?80:H>=2?60:40,l.moveBP=x;break;case"Stored Power":case"Power Trip":case"Snuggle Bug":x=20+20*(0,ee.countBoosts)(a,t.boosts),l.moveBP=x;break;case"Shadow Punish":x=55+30*(0,ee.countBoosts)(a,i.boosts),l.moveBP=x;break;case"Acrobatics":x=r.bp*(t.hasItem("Flying Gem")||!t.item?2:1),l.moveBP=x;break;case"Assurance":x=r.bp*(i.hasAbility("Parental Bond (Child)")?2:1);break;case"Wake-Up Slap":x=r.bp*(i.hasStatus("slp")?2:1),l.moveBP=x;break;case"Smelling Salts":x=r.bp*(i.hasStatus("par")?2:1),l.moveBP=x;break;case"Weather Ball":x=r.bp*(s.weather&&!s.hasWeather("Strong Winds")?2:1),l.moveBP=x;break;case"Fling":x=(0,de.getFlingPower)(t.item),l.moveBP=x,l.attackerItem=t.item;break;case"Eruption":case"Icefall":case"Water Spout":x=Math.max(1,Math.floor(150*t.curHP()/t.maxHP())),l.moveBP=x;break;case"Flail":case"Reversal":case"Shadow Vengeance":var W=Math.floor(48*t.curHP()/t.maxHP());x=W<=1?200:W<=4?150:W<=9?100:W<=16?80:W<=32?40:20,l.moveBP=x;break;case"Nature Power":if(5===a.num)r.category="Physical",r.target="allAdjacent",x=100,l.moveName="Earthquake";else switch(r.category="Special",r.secondaries=!0,s.terrain){case"Electric":x=90,l.moveName="Thunderbolt";break;case"Grassy":x=90,l.moveName="Energy Ball";break;case"Misty":x=95,l.moveName="Moonblast";break;default:x=80,l.moveName="Tri Attack"}break;case"Triple Kick":x=2===r.hits?30:3===r.hits?40:20,l.moveBP=x;break;case"Crush Grip":case"Wring Out":x=100*Math.floor(4096*i.curHP()/i.maxHP()),x=Math.floor(Math.floor((120*x+2048-1)/4096)/100)||1,l.moveBP=x;break;default:x=r.bp}if(0===x)return h;var C=[];t.hasAbility("Technician")&&x<=60||t.hasAbility("Flare Boost")&&t.hasStatus("brn")&&"Special"===r.category||t.hasAbility("Toxic Boost")&&t.hasStatus("psn","tox")&&"Physical"===r.category?(C.push(6144),l.attackerAbility=t.ability):t.hasAbility("Analytic")&&"first"!==R?(C.push(5325),l.attackerAbility=t.ability):t.hasAbility("Sand Force")&&s.hasWeather("Sand")&&r.hasType("Rock","Ground","Steel")?(C.push(5325),l.attackerAbility=t.ability,l.weather=s.weather):(t.hasAbility("Reckless")&&(r.recoil||r.hasCrashDamage)||t.hasAbility("Iron Fist")&&r.flags.punch||t.hasAbility("Cunning Blade")&&r.flags.blade)&&(C.push(4915),l.attackerAbility=t.ability),i.hasAbility("Heatproof")&&r.hasType("Fire")?(C.push(2048),l.defenderAbility=i.ability):i.hasAbility("Dry Skin")&&r.hasType("Fire")&&(C.push(5120),l.defenderAbility=i.ability),t.hasAbility("High Caliber")&&r.flags.bullet&&(C.push(5325),l.defenderAbility=i.ability),t.hasAbility("Sheer Force")&&r.secondaries&&(C.push(5325),l.attackerAbility=t.ability),t.hasAbility("Rivalry")&&![t.gender,i.gender].includes("N")&&(t.gender===i.gender?(C.push(5120),l.rivalry="buffed"):(C.push(3072),l.rivalry="nerfed"),l.attackerAbility=t.ability),t.item&&(0,de.getItemBoostType)(t.item)===r.type?(C.push(4915),l.attackerItem=t.item):t.hasItem("Muscle Band")&&"Physical"===r.category||t.hasItem("Wise Glasses")&&"Special"===r.category?(C.push(4505),l.attackerItem=t.item):t.hasItem("Adamant Orb")&&t.named("Dialga")&&r.hasType("Steel","Dragon")||t.hasItem("Lustrous Orb")&&t.named("Palkia")&&r.hasType("Water","Dragon")||t.hasItem("Griseous Orb")&&t.named("Giratina-Origin")&&r.hasType("Ghost","Dragon")?(C.push(4915),l.attackerItem=t.item):t.hasItem("".concat(r.type," Gem"))&&(C.push(a.num>5?5325:6144),l.attackerItem=t.item),r.named("Facade")&&t.hasStatus("brn","par","psn","tox")||r.named("Brine")&&i.curHP()<=i.maxHP()/2||r.named("Venoshock")&&i.hasStatus("psn","tox")?(C.push(8192),l.moveBP=2*x):a.num>5&&r.named("Knock Off")&&!M?(C.push(6144),l.moveBP=1.5*x):r.named("Solar Beam")&&s.hasWeather("Rain","Heavy Rain","Sand","Hail")&&(C.push(2048),l.moveBP=x/2,l.weather=s.weather),s.attackerSide.isHelpingHand&&(C.push(6144),l.isHelpingHand=!0),y||u||m||p?(C.push(5325),l.attackerAbility=t.ability):t.hasAbility("Mega Launcher")&&r.flags.pulse||t.hasAbility("Strong Jaw")&&r.flags.bite||t.hasAbility("Escape Artist")&&r.named("Flip Turn","U-turn","Volt Switch","Shadow Pivot","Propulsion Shot")?(C.push(6144),l.attackerAbility=t.ability):t.hasAbility("Tough Claws")&&r.flags.contact&&(C.push(5325),l.attackerAbility=t.ability);var O,E="".concat(r.type," Aura"),V=t.hasAbility(E),L=i.hasAbility(E),N=t.hasAbility("Aura Break")||i.hasAbility("Aura Break"),U=s.isAuraBreak,z=s.isFairyAura&&"Fairy"===r.type,K=s.isDarkAura&&"Dark"===r.type;(V||L||z||K)&&(U||N?(C.push(3072),l.attackerAbility=t.ability,l.defenderAbility=i.ability):(C.push(5448),V&&(l.attackerAbility=t.ability),L&&(l.defenderAbility=i.ability))),(0,ee.isGrounded)(t,s)&&(s.hasTerrain("Electric")&&r.hasType("Electric")||s.hasTerrain("Grassy")&&r.hasType("Grass"))&&(C.push(6144),l.terrain=s.terrain),(0,ee.isGrounded)(i,s)&&(s.hasTerrain("Misty")&&r.hasType("Dragon")||s.hasTerrain("Grassy")&&r.named("Bulldoze","Earthquake"))&&(C.push(2048),l.terrain=s.terrain),x=(0,ee.OF16)(Math.max(1,(0,ee.pokeRound)(x*(0,ee.chainMods)(C,41,2097152)/4096)));var Z=r.named("Foul Play")?i:t,j="Special"===r.category?"spa":"atk";l.attackEVs=r.named("Foul Play")?(0,ee.getEVDescriptionText)(a,i,j,i.nature):(0,ee.getEVDescriptionText)(a,t,j,t.nature),0===Z.boosts[j]||c&&Z.boosts[j]<0?O=Z.rawStats[j]:i.hasAbility("Unaware")?(O=Z.rawStats[j],l.defenderAbility=i.ability):(O=Z.stats[j],l.attackBoost=Z.boosts[j]),t.hasAbility("Hustle")&&"Physical"===r.category&&(O=(0,ee.pokeRound)(3*O/2),l.attackerAbility=t.ability);var _,Q=[];(i.hasAbility("Thick Fat")&&r.hasType("Fire","Ice")||i.hasAbility("Primal Warmth")&&r.hasType("Fire","Water"))&&(Q.push(2048),l.defenderAbility=i.ability),t.hasAbility("Guts")&&t.status&&"Physical"===r.category||t.curHP()<=t.maxHP()/4&&t.hasAbility("Adrenalize")||t.curHP()<=t.maxHP()/3&&(t.hasAbility("Overgrow")&&r.hasType("Grass")||t.hasAbility("Blaze")&&r.hasType("Fire")||t.hasAbility("Torrent")&&r.hasType("Water")||t.hasAbility("Swarm")&&r.hasType("Bug"))||"Special"===r.category&&t.abilityOn&&t.hasAbility("Plus","Minus")?(Q.push(6144),l.attackerAbility=t.ability):t.hasAbility("Flash Fire")&&t.abilityOn&&r.hasType("Fire")?(Q.push(6144),l.attackerAbility="Flash Fire"):t.hasAbility("Corona")&&r.hasType("Fire")?Q.push(6144):t.hasAbility("Solar Power")&&s.hasWeather("Sun","Harsh Sunshine")&&"Special"===r.category||t.named("Cherrim")&&t.hasAbility("Flower Gift")&&s.hasWeather("Sun","Harsh Sunshine")&&"Physical"===r.category?(Q.push(6144),l.attackerAbility=t.ability,l.weather=s.weather):t.hasAbility("Galaxian")&&s.isGravity&&"Special"===r.category?(Q.push(6144),l.attackerAbility=t.ability):s.attackerSide.isFlowerGift&&s.hasWeather("Sun","Harsh Sunshine")&&"Physical"===r.category?(Q.push(6144),l.weather=s.weather,l.isFlowerGiftAttacker=!0):t.hasAbility("Defeatist")&&t.curHP()<=t.maxHP()/2||t.hasAbility("Slow Start")&&t.abilityOn&&"Physical"===r.category?(Q.push(2048),l.attackerAbility=t.ability):(t.hasAbility("Huge Power","Pure Power")&&"Physical"===r.category||t.hasAbility("Mystic Power")&&"Special"===r.category)&&(Q.push(8192),l.attackerAbility=t.ability),t.hasItem("Thick Club")&&t.named("Cubone","Marowak","Marowak-Alola")&&"Physical"===r.category||t.hasItem("Deep Sea Tooth")&&t.named("Clamperl")&&"Special"===r.category||t.hasItem("Light Ball")&&t.name.startsWith("Pikachu")&&!r.isZ?(Q.push(8192),l.attackerItem=t.item):(t.hasItem("Soul Dew")&&t.named("Latios","Latias","Latios-Mega","Latias-Mega")&&"Special"===r.category||t.hasItem("Choice Band")&&"Physical"===r.category||t.hasItem("Choice Specs")&&"Special"===r.category)&&(Q.push(6144),l.attackerItem=t.item),O=(0,ee.OF16)(Math.max(1,(0,ee.pokeRound)(O*(0,ee.chainMods)(Q,410,131072)/4096))),r.named("Combardment")&&i.stats.def>i.stats.spd&&(r.overrideDefensiveStat="spd");var Y=r.overrideDefensiveStat||"Physical"===r.category?"def":"spd",q="def"===Y;l.defenseEVs=(0,ee.getEVDescriptionText)(a,i,Y,i.nature),0===i.boosts[Y]||c&&i.boosts[Y]>0||r.ignoreDefensive?_=i.rawStats[Y]:t.hasAbility("Unaware")?(_=i.rawStats[Y],l.attackerAbility=t.ability):(_=i.stats[Y],l.defenseBoost=i.boosts[Y]),s.hasWeather("Sand")&&i.hasType("Rock")&&!q&&(_=(0,ee.pokeRound)(3*_/2),l.weather=s.weather);var J=[];i.hasAbility("Marvel Scale")&&i.status&&q?(J.push(6144),l.defenderAbility=i.ability):i.named("Cherrim")&&i.hasAbility("Flower Gift")&&s.hasWeather("Sun","Harsh Sunshine")&&!q?(J.push(6144),l.defenderAbility=i.ability,l.weather=s.weather):s.defenderSide.isFlowerGift&&s.hasWeather("Sun","Harsh Sunshine")&&!q&&(J.push(6144),l.weather=s.weather,l.isFlowerGiftDefender=!0),s.hasTerrain("Grassy")&&i.hasAbility("Grass Pelt")&&q&&(J.push(6144),l.defenderAbility=i.ability),(!q&&i.hasItem("Soul Dew")&&i.named("Latios","Latias","Latios-Mega","Latias-Mega")||i.hasItem("Eviolite")&&(null===(n=a.species.get((0,o.toID)(i.name)))||void 0===n?void 0:n.nfe)||!q&&i.hasItem("Assault Vest"))&&(J.push(6144),l.defenderItem=i.item),(i.hasItem("Metal Powder")&&i.named("Ditto")&&q||i.hasItem("Deep Sea Scale")&&i.named("Clamperl")&&!q)&&(J.push(8192),l.defenderItem=i.item),i.hasAbility("Fur Coat")&&q&&(J.push(8192),l.defenderAbility=i.ability),_=(0,ee.OF16)(Math.max(1,(0,ee.pokeRound)(_*(0,ee.chainMods)(J,410,131072)/4096)));var X=ve(a,t,x,O,_,r,s,l,c),ae=4096;t.hasType(r.type)?t.hasAbility("Adaptability")?(ae=8192,l.attackerAbility=t.ability):ae=6144:t.hasAbility("Protean")&&(ae=6144,l.attackerAbility=t.ability);var te=t.hasStatus("brn")&&"Physical"===r.category&&!t.hasAbility("Guts")&&!(r.named("Facade")&&6===a.num);l.isBurned=te;var ie,re=Ae(a,t,i,r,s,l,c,P),se=(0,ee.chainMods)(re,41,131072),oe="Singles"!==s.gameType&&["allAdjacent","allAdjacentFoes"].includes(r.target);if(t.hasAbility("Parental Bond")&&1===r.hits&&!oe){var ne=t.clone();ne.ability="Parental Bond (Child)",(0,ee.checkMultihitBoost)(a,ne,i,r,s,l),ie=e(a,ne,i,r,s).damage,l.attackerAbility=t.ability}for(var le=[],he=0;he<16;he++)le[he]=(0,ee.getFinalDamage)(X,he,P,te,ae,se);if(r.dropsStats&&(r.timesUsed||0)>1){var ce=t.hasAbility("Simple")?2:1;l.moveTurns="over ".concat(r.timesUsed," turns");for(var ye=t.hasItem("White Herb"),ue=!1,me=t.boosts[j],pe=function(e){var a=(0,ee.getModifiedStat)(O,me),i=0;le=le.map((function(r){if(e){var s=(0,ee.getBaseDamage)(t.level,x,a,_),o=(0,ee.getFinalDamage)(s,i,P,te,ae,se);return i++,r+o}return r})),t.hasAbility("Contrary")?(me=Math.min(6,me+r.dropsStats),l.attackerAbility=t.ability):(me=Math.max(-6,me-r.dropsStats*ce),t.hasAbility("Simple")&&(l.attackerAbility=t.ability)),ye&&t.boosts[j]<0&&!ue&&(me+=r.dropsStats*ce,ue=!0,l.attackerItem=t.item)},be=0;be<r.timesUsed;be++)pe(be)}if(r.hits>1){var fe=i.boosts.def,ge=function(e){var o=0;le=le.map((function(n){if(e){var h=Ae(a,t,i,r,s,l,c,P,e),d=(0,ee.chainMods)(h,41,131072),y=(0,ee.getModifiedStat)(_,fe),u=ve(a,t,x,O,y,r,s,l,c),m=(0,ee.getFinalDamage)(u,o,P,te,ae,d);return o++,n+m}return n})),q&&"Weak Armor"===i.ability&&(fe=Math.max(-6,fe-1),l.defenderAbility="Weak Armor")};for(be=0;be<r.hits;be++)ge(be)}return l.attackBoost=r.named("Foul Play")?i.boosts[j]:t.boosts[j],h.damage=ie?[le,ie]:le,h};o=require("./util"),ee=require("../util");function ke(e,a){var t=Math.min(6,Math.max(-6,2*a));return t>0?Math.floor(e*(2+t)/2):t<0?Math.floor(2*e/(2-t)):e}e.calculateDPP=function(e,a,t,i,r){var s;(0,o.checkAirLock)(a,r),(0,o.checkAirLock)(t,r),(0,o.checkForecast)(a,r.weather),(0,o.checkForecast)(t,r.weather),(0,o.checkItem)(a),(0,o.checkItem)(t),(0,o.checkIntimidate)(e,a,t),(0,o.checkIntimidate)(e,t,a),(0,o.checkDownload)(a,t),(0,o.checkDownload)(t,a),(0,o.checkSearchEngine)(t,a),(0,o.checkSearchEngine)(a,t),(0,o.checkInflate)(a),(0,o.checkInflate)(t),a.stats.spe=(0,o.getFinalSpeed)(e,a,r,r.attackerSide),t.stats.spe=(0,o.getFinalSpeed)(e,t,r,r.defenderSide);var n={attackerName:a.name,moveName:i.name,defenderName:t.name},l=new $.Result(e,a,t,i,r,0,n);if("Status"===i.category&&!i.named("Nature Power"))return l;if(r.defenderSide.isProtected&&!i.breaksProtect)return n.isProtected=!0,l;a.hasAbility("Mold Breaker")&&(t.ability="",n.attackerAbility=a.ability);var h=i.isCrit&&!t.hasAbility("Battle Armor","Shell Armor"),c=i.bp;if(i.named("Weather Ball"))r.hasWeather("Sun")?(i.type="Fire",c*=2):r.hasWeather("Rain")?(i.type="Water",c*=2):r.hasWeather("Sand")?(i.type="Rock",c*=2):r.hasWeather("Hail")?(i.type="Ice",c*=2):i.type="Normal",n.weather=r.weather,n.moveType=i.type,n.moveBP=c;else if(i.named("Judgment")&&a.item&&a.item.includes("Plate"))i.type=(0,de.getItemBoostType)(a.item);else if(i.named("Primal Burst")&&a.item&&a.item.includes("Orb"))i.type=(0,items_2.getOrbType)(a.item);else if(i.named("Natural Gift")&&a.item&&a.item.includes("Berry")){var d=(0,de.getNaturalGift)(e,a.item);i.type=d.t,i.bp=d.p,n.attackerItem=a.item,n.moveBP=i.bp,n.moveType=i.type}a.hasAbility("Normalize")&&!i.named("Struggle")&&(i.type="Normal",n.attackerAbility=a.ability),a.hasAbility("Cunning Blade")&&i.flags.blade&&(i.category="Special",i.flags.contact=0),a.hasAbility("Melody Allegretto")&&i.flags.sound&&(i.priority=1,n.attackerAbility=a.ability);var y=a.hasAbility("Scrappy")||r.defenderSide.isForesight,u=r.defenderSide.isMiracleEye||a.hasAbility("Psyche Control"),m=["Normal","Fire","Water","Electric","Grass","Ice","Fighting","Poison","Ground","Flying","Psychic","Bug","Rock","Ghost","Dragon","Dark","Steel"],p=t.types[0],b=t.types[1];b&&p!==b&&m.indexOf(p)>m.indexOf(b)&&(p=(s=P([b,p],2))[0],b=s[1]);var f=a.hasAbility("Bone Master")&&!!i.flags.bone,g=(0,o.getMoveEffectiveness)(e,i,p,y,u,r.isGravity,!1,f),S=b?(0,o.getMoveEffectiveness)(e,i,b,y,u,r.isGravity,!1,f):1,v=g*S;if(0===v&&i.hasType("Ground")&&t.hasItem("Iron Ball")&&!t.hasAbility("Klutz")&&(0===g?g=1:t.types[1]&&0===S&&(S=1),v=g*S),0===v)return l;if(t.hasAbility("Cloud Guard")&&t.hasType("Flying")&&e.types.get((0,ee.toID)(i.type)).effectiveness.Flying>1&&(v/=2,n.defenderAbility=t.ability),!(i.hasType("???")||i.named("Fire Fang"))&&t.hasAbility("Wonder Guard")&&v<=1||i.hasType("Fire")&&t.hasAbility("Flash Fire","Flame Absorb")||i.hasType("Water")&&t.hasAbility("Dry Skin","Water Absorb")||i.hasType("Bug")&&t.hasAbility("Bugcatcher")||i.hasType("Ground")&&t.hasAbility("Clay Construction")||i.hasType("Electric")&&t.hasAbility("Motor Drive","Volt Absorb")||i.hasType("Ground")&&!r.isGravity&&(!t.hasAbility("Bone Master")||!i.flags.bone)&&!t.hasItem("Iron Ball")&&(t.hasAbility("Levitate")||t.hasAbility("Inflate")&&t.abilityOn)||i.flags.sound&&t.hasAbility("Soundproof")||i.flags.blade&&t.hasAbility("Bladeproof")||i.hasType("Ghost","Dark")&&t.hasAbility("Baku Shield")||i.hasType("Poison")&&t.hasAbility("Acid Absorb")||i.hasType("Dark")&&t.hasAbility("Karma")||t.named("Kiwuit")&&t.hasAbility("Ambrosia")&&t.item&&e.items.get((0,ee.toID)(t.item)).isBerry&&(0,de.getNaturalGift)(e,t.item).t===i.type)return n.defenderAbility=t.ability,l;n.HPEVs="".concat(t.evs.hp," HP");var A=(0,o.handleFixedDamageMoves)(a,i);if(A)return l.damage=A,l;if(i.named("Cat Burglary")){var k=void 0;for(k in t.boosts)t.boosts[k]>0&&(a.boosts[k]+=a.hasAbility("Contrary")?-t.boosts[k]:t.boosts[k],a.boosts[k]>6&&(a.boosts[k]=6),a.boosts[k]<-6&&(a.boosts[k]=-6),a.stats[k]=(0,o.getModifiedStat)(a.rawStats[k],a.boosts[k]),t.boosts[k]=0,t.stats[k]=t.rawStats[k])}i.hits>1&&(n.hits=i.hits);var M=a.stats.spe>t.stats.spe?"first":"last";switch(i.name){case"Brine":t.curHP()<=t.maxHP()/2&&(c*=2,n.moveBP=c);break;case"Eruption":case"Icefall":case"Water Spout":c=Math.max(1,Math.floor(c*a.curHP()/a.maxHP())),n.moveBP=c;break;case"Facade":a.hasStatus("par","psn","tox","brn")&&(c=2*i.bp,n.moveBP=c);break;case"Flail":case"Reversal":case"Shadow Vengeance":var T=Math.floor(64*a.curHP()/a.maxHP());c=T<=1?200:T<=5?150:T<=12?100:T<=21?80:T<=42?40:20,n.moveBP=c;break;case"Fling":c=(0,de.getFlingPower)(a.item),n.moveBP=c,n.attackerItem=a.item;break;case"Grass Knot":case"Low Kick":var w=t.weightkg;c=w>=200?120:w>=100?100:w>=50?80:w>=25?60:w>=10?40:20,n.moveBP=c;break;case"Infernal Parade":case"Shadow Sorcery":c=i.bp*(t.status?2:1),n.moveBP=c;break;case"Snuggle Bug":c=20+20*(0,o.countBoosts)(e,a.boosts),n.moveBP=c;break;case"Shadow Punish":c=55+30*(0,o.countBoosts)(e,t.boosts),n.moveBP=c;break;case"Gyro Ball":c=Math.min(150,Math.floor(25*t.stats.spe/a.stats.spe)),n.moveBP=c;break;case"Payback":"first"!==M&&(c*=2,n.moveBP=c);break;case"Punishment":c=Math.min(200,60+20*(0,o.countBoosts)(e,t.boosts)),n.moveBP=c;break;case"Wake-Up Slap":t.hasStatus("slp")&&(c*=2,n.moveBP=c);break;case"Nature Power":i.category="Special",i.secondaries=!0,c=80,n.moveName="Tri Attack";break;case"Crush Grip":case"Wring Out":c=Math.floor(120*t.curHP()/t.maxHP())+1,n.moveBP=c;break;default:c=i.bp}if(0===c)return l;r.attackerSide.isHelpingHand&&(c=Math.floor(1.5*c),n.isHelpingHand=!0);var B="Physical"===i.category;a.hasItem("Muscle Band")&&B||a.hasItem("Wise Glasses")&&!B?(c=Math.floor(1.1*c),n.attackerItem=a.item):(i.hasType((0,de.getItemBoostType)(a.item))||a.hasItem("Adamant Orb")&&a.named("Dialga")&&i.hasType("Steel","Dragon")||a.hasItem("Lustrous Orb")&&a.named("Palkia")&&i.hasType("Water","Dragon")||a.hasItem("Griseous Orb")&&a.named("Giratina-Origin")&&i.hasType("Ghost","Dragon"))&&(c=Math.floor(1.2*c),n.attackerItem=a.item),a.hasAbility("Reckless")&&(i.recoil||i.hasCrashDamage)||a.hasAbility("Iron Fist")&&i.flags.punch||a.hasAbility("Cunning Blade")&&i.flags.blade?(c=Math.floor(1.2*c),n.attackerAbility=a.ability):(a.curHP()<=a.maxHP()/3&&(a.hasAbility("Overgrow")&&i.hasType("Grass")||a.hasAbility("Blaze")&&i.hasType("Fire")||a.hasAbility("Torrent")&&i.hasType("Water")||a.hasAbility("Swarm")&&i.hasType("Bug"))||a.hasAbility("Technician")&&c<=60||a.hasAbility("Escape Artist")&&i.named("Flip Turn","U-turn","Volt Switch","Shadow Pivot","Propulsion Shot"))&&(c=Math.floor(1.5*c),n.attackerAbility=a.ability),t.hasAbility("Heatproof")&&i.hasType("Fire")||t.hasAbility("Thick Fat")&&i.hasType("Fire","Ice")?(c=Math.floor(.5*c),n.defenderAbility=t.ability):t.hasAbility("Dry Skin")&&i.hasType("Fire")&&(c=Math.floor(1.25*c),n.defenderAbility=t.ability),a.hasAbility("High Caliber")&&i.flags.bullet&&(c=Math.floor(1.3*c),n.defenderAbility=t.ability);var F,x=B?"atk":"spa";n.attackEVs=(0,o.getEVDescriptionText)(e,a,x,a.nature);var R=a.boosts[x],G=a.rawStats[x];0===R||h&&R<0?F=G:t.hasAbility("Unaware")?(F=G,n.defenderAbility=t.ability):a.hasAbility("Simple")?(F=ke(G,R),n.attackerAbility=a.ability,n.attackBoost=R):(F=(0,o.getModifiedStat)(G,R),n.attackBoost=R),B&&a.hasAbility("Pure Power","Huge Power")||!B&&a.hasAbility("Mystic Power")?(F*=2,n.attackerAbility=a.ability):r.hasWeather("Sun")&&(a.hasAbility("Solar Power")||a.hasAbility("Flower Gift")||"Physical"==i.category)?(F=Math.floor(1.5*F),n.attackerAbility=a.ability,n.weather=r.weather):a.hasAbility("Galaxian")&&r.isGravity&&"Special"===i.category?(F=Math.floor(1.5*F),n.attackerAbility=a.ability):r.attackerSide.isFlowerGift&&r.hasWeather("Sun")&&B?(F=Math.floor(1.5*F),n.weather=r.weather,n.isFlowerGiftAttacker=!0):B&&(a.hasAbility("Hustle")||a.hasAbility("Guts")&&a.status)||a.curHP()<=a.maxHP()/4&&a.hasAbility("Adrenalize")||!B&&a.abilityOn&&a.hasAbility("Plus","Minus")?(F=Math.floor(1.5*F),n.attackerAbility=a.ability):B&&a.hasAbility("Slow Start")&&a.abilityOn?(F=Math.floor(F/2),n.attackerAbility=a.ability):t.hasAbility("Primal Warmth")&&i.hasType("Fire","Water")&&(F=Math.floor(F/2),n.defenderAbility=t.ability),(B?a.hasItem("Choice Band"):a.hasItem("Choice Specs"))||!B&&a.hasItem("Soul Dew")&&a.named("Latios","Latias")?(F=Math.floor(1.5*F),n.attackerItem=a.item):(a.hasItem("Light Ball")&&a.named("Pikachu")||a.hasItem("Thick Club")&&a.named("Cubone","Marowak")&&B||a.hasItem("Deep Sea Tooth")&&a.named("Clamperl")&&!B)&&(F*=2,n.attackerItem=a.item),i.named("Combardment")&&t.stats.def>t.stats.spd&&(i.overrideDefensiveStat="spd");var I,D=i.overrideDefensiveStat||"Physical"===i.category?"def":"spd";n.defenseEVs=(0,o.getEVDescriptionText)(e,t,D,t.nature);var H=t.boosts[D],W=t.rawStats[D];0===H||h&&H>0?I=W:a.hasAbility("Unaware")?(I=W,n.attackerAbility=a.ability):t.hasAbility("Simple")?(I=ke(W,H),n.defenderAbility=t.ability,n.defenseBoost=H):(I=(0,o.getModifiedStat)(W,H),n.defenseBoost=H),t.hasAbility("Marvel Scale")&&t.status&&B?(I=Math.floor(1.5*I),n.defenderAbility=t.ability):t.hasAbility("Flower Gift")&&r.hasWeather("Sun")&&!B?(I=Math.floor(1.5*I),n.defenderAbility=t.ability,n.weather=r.weather):r.defenderSide.isFlowerGift&&r.hasWeather("Sun")&&!B&&(I=Math.floor(1.5*I),n.weather=r.weather,n.isFlowerGiftDefender=!0),t.hasItem("Soul Dew")&&t.named("Latios","Latias")&&!B?(I=Math.floor(1.5*I),n.defenderItem=t.item):(t.hasItem("Deep Sea Scale")&&t.named("Clamperl")&&!B||t.hasItem("Metal Powder")&&t.named("Ditto")&&B)&&(I*=2,n.defenderItem=t.item),r.hasWeather("Sand")&&t.hasType("Rock")&&!B&&(I=Math.floor(1.5*I),n.weather=r.weather),(i.named("Explosion")||i.named("Self-Destruct"))&&(I=Math.floor(.5*I)),I<1&&(I=1);var C=Math.floor(Math.floor(Math.floor(2*a.level/5+2)*c*F/50)/I);if(a.hasStatus("brn")&&B&&!a.hasAbility("Guts")&&(C=Math.floor(.5*C),n.isBurned=!0),!h){var O="Singles"!==r.gameType?2/3:.5;B&&r.defenderSide.isReflect?(C=Math.floor(C*O),n.isReflect=!0):!B&&r.defenderSide.isLightScreen&&(C=Math.floor(C*O),n.isLightScreen=!0)}"Singles"!==r.gameType&&["allAdjacent","allAdjacentFoes"].includes(i.target)&&(C=Math.floor(3*C/4)),r.hasWeather("Sun")&&i.hasType("Fire")||r.hasWeather("Rain")&&i.hasType("Water")||r.hasWeather("Miasma")&&i.hasType("Poison")?(C=Math.floor(1.5*C),n.weather=r.weather):(r.hasWeather("Sun")&&i.hasType("Water")||r.hasWeather("Rain")&&i.hasType("Fire")||i.named("Solar Beam")&&r.hasWeather("Rain","Sand","Hail"))&&(C=Math.floor(.5*C),n.weather=r.weather),a.hasAbility("Flash Fire")&&a.abilityOn&&i.hasType("Fire")&&(C=Math.floor(1.5*C),n.attackerAbility="Flash Fire"),a.hasAbility("Corona")&&i.hasType("Fire")&&(C=Math.floor(1.5*C)),C+=2,h&&(a.hasAbility("Sniper")?(C*=3,n.attackerAbility=a.ability):C*=2,n.isCritical=h),a.hasItem("Life Orb")&&(C=Math.floor(1.3*C),n.attackerItem=a.item),i.named("Pursuit")&&"out"===r.defenderSide.isSwitching&&(a.hasAbility("Technician")?C=Math.floor(1*C):(C=Math.floor(2*C),n.isSwitching="out"));var E=1;i.hasType.apply(i,N([],P(a.types),!1))&&(a.hasAbility("Adaptability")?(E=2,n.attackerAbility=a.ability):E=1.5);var V=1;t.hasAbility("Filter","Solid Rock")&&v>1&&(V=.75,n.defenderAbility=t.ability);var L=1;t.hasAbility("Bagwormicade")&&v>1&&(L=.5,n.defenderAbility=t.ability);var U=1;t.hasAbility("Enfeebling Venom")&&a.hasStatus("psn","tox")&&(U=.5,n.defenderAbility=t.ability);var z=1;a.hasItem("Expert Belt")&&v>1&&(z=1.2,n.attackerItem=a.item);var K=1;a.hasAbility("Tinted Lens")&&v<1&&(K=2,n.attackerAbility=a.ability);var Z=1;i.hasType((0,de.getBerryResistType)(t.item))&&(v>1||i.hasType("Normal"))&&(Z=.5,n.defenderItem=t.item);for(var j=[],_=0;_<16;_++)j[_]=Math.floor(C*(85+_)/100),j[_]=Math.floor(j[_]*E),j[_]=Math.floor(j[_]*g),j[_]=Math.floor(j[_]*S),j[_]=Math.floor(j[_]*V),j[_]=Math.floor(j[_]*L),j[_]=Math.floor(j[_]*U),j[_]=Math.floor(j[_]*z),j[_]=Math.floor(j[_]*K),j[_]=Math.floor(j[_]*Z),j[_]=Math.max(1,j[_]);if(l.damage=j,i.hits>1)for(var Q=function(e){var a=0;l.damage=l.damage.map((function(t){if(e){var i=0;return i=Math.floor(C*(85+a)/100),i=Math.floor(i*E),i=Math.floor(i*g),i=Math.floor(i*S),i=Math.floor(i*V),i=Math.floor(i*z),i=Math.floor(i*K),i=Math.max(1,i),a++,t+i}return t}))},Y=0;Y<i.hits;Y++)Q(Y);return l};ee=require("./util"),ee=require("../util");e.calculateADV=function(e,a,t,i,r){var s;(0,ee.checkAirLock)(a,r),(0,ee.checkAirLock)(t,r),(0,ee.checkForecast)(a,r.weather),(0,ee.checkForecast)(t,r.weather),(0,ee.checkIntimidate)(e,a,t),(0,ee.checkIntimidate)(e,t,a),(0,ee.checkSearchEngine)(t,a),(0,ee.checkSearchEngine)(a,t),(0,ee.checkInflate)(a),(0,ee.checkInflate)(t),a.stats.spe=(0,ee.getFinalSpeed)(e,a,r,r.attackerSide),t.stats.spe=(0,ee.getFinalSpeed)(e,t,r,r.defenderSide);var o={attackerName:a.name,moveName:i.name,defenderName:t.name},n=new $.Result(e,a,t,i,r,0,o);if("Status"===i.category&&!i.named("Nature Power"))return n;if(r.defenderSide.isProtected)return o.isProtected=!0,n;i.named("Weather Ball")?(i.type=r.hasWeather("Sun")?"Fire":r.hasWeather("Rain")?"Water":r.hasWeather("Sand")?"Rock":r.hasWeather("Hail")?"Ice":"Normal",i.category="Rock"===i.type?"Physical":"Special",o.weather=r.weather,o.moveType=i.type,o.moveBP=i.bp):i.named("Primal Burst")&&a.item&&a.item.includes("Orb")&&(i.type=(0,items_2.getOrbType)(a.item)),a.hasAbility("Melody Allegretto")&&i.flags.sound&&(i.priority=1,o.attackerAbility=a.ability);var l=["Normal","Fire","Water","Electric","Grass","Ice","Fighting","Poison","Ground","Flying","Psychic","Bug","Rock","Ghost","Dragon","Dark","Steel"],h=t.types[0],c=t.types[1];c&&h!==c&&l.indexOf(h)>l.indexOf(c)&&(h=(s=P([c,h],2))[0],c=s[1]);var d=a.hasAbility("Bone Master")&&!!i.flags.bone,y=r.defenderSide.isMiracleEye||a.hasAbility("Psyche Control"),u=(0,ee.getMoveEffectiveness)(e,i,h,r.defenderSide.isForesight,y,!1,!1,d)*(c?(0,ee.getMoveEffectiveness)(e,i,c,r.defenderSide.isForesight,y,!1,!1,d):1);if(0===u)return n;if(t.hasAbility("Cloud Guard")&&t.hasType("Flying")&&e.types.get((0,ee.toID)(i.type)).effectiveness.Flying>1&&(u/=2,o.defenderAbility=t.ability),t.hasAbility("Flash Fire","Flame Absorb")&&i.hasType("Fire")||i.hasType("Bug")&&t.hasAbility("Bugcatcher")||i.hasType("Ground")&&t.hasAbility("Clay Construction")||(!t.hasAbility("Bone Master")||!i.flags.bone)&&(t.hasAbility("Levitate")||t.hasAbility("Inflate")&&t.abilityOn)&&i.hasType("Ground")||t.hasAbility("Volt Absorb")&&i.hasType("Electric")||t.hasAbility("Water Absorb")&&i.hasType("Water")||t.hasAbility("Wonder Guard")&&!i.hasType("???")&&u<=1||t.hasAbility("Soundproof")&&i.flags.sound||i.flags.blade&&t.hasAbility("Bladeproof")||i.hasType("Ghost","Dark")&&t.hasAbility("Baku Shield")||i.hasType("Poison")&&t.hasAbility("Acid Absorb")||i.hasType("Dark")&&t.hasAbility("Karma")||t.named("Kiwuit")&&t.hasAbility("Ambrosia")&&t.item&&e.items.get((0,ee.toID)(t.item)).isBerry&&(0,de.getNaturalGift)(e,t.item).t===i.type)return o.defenderAbility=t.ability,n;o.HPEVs="".concat(t.evs.hp," HP");var m=(0,ee.handleFixedDamageMoves)(a,i);if(m)return n.damage=m,n;if(i.named("Cat Burglary")){var p=void 0;for(p in t.boosts)t.boosts[p]>0&&(a.boosts[p]+=a.hasAbility("Contrary")?-t.boosts[p]:t.boosts[p],a.boosts[p]>6&&(a.boosts[p]=6),a.boosts[p]<-6&&(a.boosts[p]=-6),a.stats[p]=(0,ee.getModifiedStat)(a.rawStats[p],a.boosts[p]),t.boosts[p]=0,t.stats[p]=t.rawStats[p])}i.hits>1&&(o.hits=i.hits);var b=i.bp;switch(i.name){case"Flail":case"Reversal":case"Shadow Vengeance":var f=Math.floor(48*a.curHP()/a.maxHP());b=f<=1?200:f<=4?150:f<=9?100:f<=16?80:f<=32?40:20,o.moveBP=b;break;case"Eruption":case"Icefall":case"Water Spout":b=Math.max(1,Math.floor(150*a.curHP()/a.maxHP())),o.moveBP=b;break;case"Low Kick":var g=t.weightkg;b=g>=200?120:g>=100?100:g>=50?80:g>=25?60:g>=10?40:20,o.moveBP=b;break;case"Infernal Parade":case"Shadow Sorcery":b=i.bp*(t.status?2:1),o.moveBP=b;break;case"Snuggle Bug":b=20+20*(0,ee.countBoosts)(e,a.boosts),o.moveBP=b;break;case"Shadow Punish":b=55+30*(0,ee.countBoosts)(e,t.boosts),o.moveBP=b;break;case"Facade":a.hasStatus("par","psn","tox","brn")&&(b=2*i.bp,o.moveBP=b);break;case"Nature Power":i.category="Physical",b=60,o.moveName="Swift";break;default:b=i.bp}if(0===b)return n;var S="Physical"===i.category,v=S?"atk":"spa";o.attackEVs=(0,ee.getEVDescriptionText)(e,a,v,a.nature),i.named("Combardment")&&t.stats.def>t.stats.spd&&(i.overrideDefensiveStat="spd");var A=i.overrideDefensiveStat||"Physical"===i.category?"def":"spd";o.defenseEVs=(0,ee.getEVDescriptionText)(e,t,A,t.nature);var k=a.rawStats[v],M=t.rawStats[A];(S&&a.hasAbility("Huge Power","Pure Power")||!S&&a.hasAbility("Mystic Power"))&&(k*=2,o.attackerAbility=a.ability),!a.hasItem("Sea Incense")&&i.hasType((0,de.getItemBoostType)(a.item))?(k=Math.floor(1.1*k),o.attackerItem=a.item):a.hasItem("Sea Incense")&&i.hasType("Water")?(k=Math.floor(1.05*k),o.attackerItem=a.item):S&&a.hasItem("Choice Band")||!S&&a.hasItem("Soul Dew")&&a.named("Latios","Latias")?(k=Math.floor(1.5*k),o.attackerItem=a.item):(!S&&a.hasItem("Deep Sea Tooth")&&a.named("Clamperl")||!S&&a.hasItem("Light Ball")&&a.named("Pikachu")||S&&a.hasItem("Thick Club")&&a.named("Cubone","Marowak"))&&(k*=2,o.attackerItem=a.item),!S&&t.hasItem("Soul Dew")&&t.named("Latios","Latias")?(M=Math.floor(1.5*M),o.defenderItem=t.item):(!S&&t.hasItem("Deep Sea Scale")&&t.named("Clamperl")||S&&t.hasItem("Metal Powder")&&t.named("Ditto"))&&(M*=2,o.defenderItem=t.item),t.hasAbility("Thick Fat")&&i.hasType("Fire","Ice")||t.hasAbility("Primal Warmth")&&i.hasType("Fire","Water")?(k=Math.floor(k/2),o.defenderAbility=t.ability):S&&t.hasAbility("Marvel Scale")&&t.status&&(M=Math.floor(1.5*M),o.defenderAbility=t.ability),S&&(a.hasAbility("Hustle")||a.hasAbility("Guts")&&a.status)||a.curHP()<=a.maxHP()/4&&a.hasAbility("Adrenalize")||!S&&a.abilityOn&&a.hasAbility("Plus","Minus")?(k=Math.floor(1.5*k),o.attackerAbility=a.ability):(a.curHP()<=a.maxHP()/3&&(a.hasAbility("Overgrow")&&i.hasType("Grass")||a.hasAbility("Blaze")&&i.hasType("Fire")||a.hasAbility("Torrent")&&i.hasType("Water")||a.hasAbility("Swarm")&&i.hasType("Bug"))||a.hasAbility("Escape Artist")&&i.named("Flip Turn","U-turn","Volt Switch","Shadow Pivot","Propulsion Shot"))&&(b=Math.floor(1.5*b),o.attackerAbility=a.ability),i.named("Explosion","Self-Destruct")&&(M=Math.floor(M/2));var T=i.isCrit&&!t.hasAbility("Battle Armor","Shell Armor"),w=a.boosts[v],B=t.boosts[A];(w>0||!T&&w<0)&&(k=(0,ee.getModifiedStat)(k,w),o.attackBoost=w),(B<0||!T&&B>0)&&(M=(0,ee.getModifiedStat)(M,B),o.defenseBoost=B);var F=a.level,x=Math.floor(Math.floor(Math.floor(2*F/5+2)*k*b/M)/50);if(a.hasStatus("brn")&&S&&!a.hasAbility("Guts")&&(x=Math.floor(x/2),o.isBurned=!0),!T){var R="Singles"!==r.gameType?2/3:.5;S&&r.defenderSide.isReflect?(x=Math.floor(x*R),o.isReflect=!0):!S&&r.defenderSide.isLightScreen&&(x=Math.floor(x*R),o.isLightScreen=!0)}i.named("Pursuit")&&"out"===r.defenderSide.isSwitching&&(x=Math.floor(2*x),o.isSwitching="out"),"Singles"!==r.gameType&&"allAdjacentFoes"===i.target&&(x=Math.floor(x/2)),r.hasWeather("Sun")&&i.hasType("Fire")||r.hasWeather("Rain")&&i.hasType("Water")||r.hasWeather("Miasma")&&i.hasType("Poison")?(x=Math.floor(1.5*x),o.weather=r.weather):(r.hasWeather("Sun")&&i.hasType("Water")||r.hasWeather("Rain")&&i.hasType("Fire")||i.named("Solar Beam")&&r.hasWeather("Rain","Sand","Hail"))&&(x=Math.floor(x/2),o.weather=r.weather),a.hasAbility("Flash Fire")&&a.abilityOn&&i.hasType("Fire")&&(x=Math.floor(1.5*x),o.attackerAbility="Flash Fire"),a.hasAbility("Corona")&&i.hasType("Fire")&&(x=Math.floor(1.5*x)),x=("Physical"===i.category?Math.max(1,x):x)+2,T&&(x*=2,o.isCritical=!0),i.named("Weather Ball")&&r.weather&&(x*=2,o.moveBP=2*b),r.attackerSide.isHelpingHand&&(x=Math.floor(1.5*x),o.isHelpingHand=!0),i.hasType.apply(i,N([],P(a.types),!1))&&(x=Math.floor(1.5*x)),x=Math.floor(x*u),t.hasAbility("Bagwormicade")&&u>1&&(x=Math.floor(.5*x)),t.hasAbility("Enfeebling Venom")&&a.hasStatus("psn","tox")&&(x=Math.floor(.5*x)),n.damage=[];for(var G=85;G<=100;G++)n.damage[G-85]=Math.max(1,Math.floor(x*G/100));if(i.hits>1)for(var I=function(e){var a=85;n.damage=n.damage.map((function(t){if(e){var i=Math.max(1,Math.floor(x*a/100));return a++,t+i}return t}))},D=0;D<i.hits;D++)I(D);return n},e.calculateRBYGSC=function(e,a,t,i,r){var s;(0,ee.computeFinalStats)(e,a,t,r,"atk","def","spa","spd","spe");var o={attackerName:a.name,moveName:i.name,defenderName:t.name},n=new $.Result(e,a,t,i,r,0,o);if("Status"===i.category)return n;if(r.defenderSide.isProtected)return o.isProtected=!0,n;if(1===e.num&&(d=(0,ee.handleFixedDamageMoves)(a,i)))return n.damage=d,n;var l=["Normal","Fire","Water","Electric","Grass","Ice","Fighting","Poison","Ground","Flying","Psychic","Bug","Rock","Ghost","Dragon","Dark","Steel"],h=t.types[0],c=t.types[1];c&&h!==c&&2===e.num&&l.indexOf(h)>l.indexOf(c)&&(h=(s=P([c,h],2))[0],c=s[1]);var d,y=(0,ee.getMoveEffectiveness)(e,i,h,r.defenderSide.isForesight),u=c?(0,ee.getMoveEffectiveness)(e,i,c,r.defenderSide.isForesight):1,m=y*u;if(0===m)return n;if(2===e.num&&(d=(0,ee.handleFixedDamageMoves)(a,i)))return n.damage=d,n;if(i.hits>1&&(o.hits=i.hits),i.named("Flail","Reversal")){i.isCrit=!1;var p=Math.floor(48*a.curHP()/a.maxHP());i.bp=p<=1?200:p<=4?150:p<=9?100:p<=16?80:p<=32?40:20,o.moveBP=i.bp}else i.named("Present")&&!i.bp&&(i.bp=40);if(0===i.bp)return n;var b="Physical"===i.category,f=b?"atk":"spa",g=b?"def":"spd",S=a.stats[f],v=t.stats[g],A=i.isCrit&&(1===e.num||2===e.num&&a.boosts[f]<=t.boosts[g]),k=a.level;if(A?(S=a.rawStats[f],v=t.rawStats[g],1===e.num&&(k*=2,o.isCritical=!0)):(0!==a.boosts[f]&&(o.attackBoost=a.boosts[f]),0!==t.boosts[g]&&(o.defenseBoost=t.boosts[g]),b&&a.hasStatus("brn")&&(S=Math.floor(S/2),o.isBurned=!0)),i.named("Explosion","Self-Destruct")&&(v=Math.floor(v/2)),A||(b&&r.defenderSide.isReflect?(v*=2,o.isReflect=!0):!b&&r.defenderSide.isLightScreen&&(v*=2,o.isLightScreen=!0)),(a.named("Pikachu")&&a.hasItem("Light Ball")&&!b||a.named("Cubone","Marowak")&&a.hasItem("Thick Club")&&b)&&(S*=2,o.attackerItem=a.item),(S>255||v>255)&&(S=Math.floor(S/4)%256,v=Math.floor(v/4)%256),i.named("Present")){var M={Normal:0,Fighting:1,Flying:2,Poison:3,Ground:4,Rock:5,Bug:7,Ghost:8,Steel:9,"???":19,Fire:20,Water:21,Grass:22,Electric:23,Psychic:24,Ice:25,Dragon:26,Dark:27};S=10,v=Math.max(M[a.types[1]?a.types[1]:a.types[0]],1),k=Math.max(M[t.types[1]?t.types[1]:t.types[0]],1)}t.named("Ditto")&&t.hasItem("Metal Powder")&&(v=Math.floor(1.5*v),o.defenderItem=t.item);var T=Math.floor(Math.floor(Math.floor(2*k/5+2)*Math.max(1,S)*i.bp/Math.max(1,v))/50);2===e.num&&i.isCrit&&(T*=2,o.isCritical=!0),i.named("Pursuit")&&"out"===r.defenderSide.isSwitching&&(T=Math.floor(2*T),o.isSwitching="out");var w=a.hasItem("Dragon Fang")?void 0:(0,de.getItemBoostType)(a.hasItem("Dragon Scale")?"Dragon Fang":a.item);if(i.hasType(w)&&(T=Math.floor(1.1*T),o.attackerItem=a.item),T=Math.min(997,T)+2,r.hasWeather("Sun")&&i.hasType("Fire")||r.hasWeather("Rain")&&i.hasType("Water")||r.hasWeather("Miasma")&&i.hasType("Poison")?(T=Math.floor(1.5*T),o.weather=r.weather):(r.hasWeather("Sun")&&i.hasType("Water")||r.hasWeather("Rain")&&(i.hasType("Fire")||i.named("Solar Beam")))&&(T=Math.floor(T/2),o.weather=r.weather),i.hasType.apply(i,N([],P(a.types),!1))&&(T=Math.floor(1.5*T)),1===e.num?(T=Math.floor(T*y),T=Math.floor(T*u)):T=Math.floor(T*m),i.named("Flail","Reversal"))return n.damage=T,n;n.damage=[];for(var B=217;B<=255;B++)2===e.num?n.damage[B-217]=Math.max(1,Math.floor(T*B/255)):n.damage[B-217]=1===T?1:Math.floor(T*B/255);if(i.hits>1)for(var F=function(a){var t=217;n.damage=n.damage.map((function(i){if(a){var r=0;return r=2===e.num?Math.max(1,Math.floor(T*t/255)):1===T?1:Math.floor(T*t/255),t++,i+r}return i}))},x=0;x<i.hits;x++)F(x);return n};var Pe=e,Me=e,Te=e,we=e,Be=e,Fe=e,xe=[function(){},Me.calculateRBYGSC,Me.calculateRBYGSC,Te.calculateADV,we.calculateDPP,Be.calculateBWXY,Be.calculateBWXY,Fe.calculateSMSSSV,Fe.calculateSMSSSV,Fe.calculateSMSSSV];e.calculate=function(e,a,t,i,r){return xe[e.num](e,a.clone(),t.clone(),i.clone(),r?r.clone():new Pe.Field)},window.calc=Object.assign(window.calc||{},{Field:e.Field,Side:e.Side,Pokemon:e.Pokemon,Move:e.Move,calculate:e.calculate,Result:e.Result,toID:e.toID,STATS:e.STATS,Stats:e.Stats})}();